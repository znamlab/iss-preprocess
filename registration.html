<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Channel brightness and illumination correction" href="correction.html" /><link rel="prev" title="Welcome to iss-preprocess’s documentation!" href="index.html" />

    <!-- Generated with Sphinx 6.1.3 and Furo 2022.12.07 -->
        <title>Registration - iss-preprocess 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">iss-preprocess 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">iss-preprocess 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="correction.html">Channel brightness and illumination correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="bleedthrough.html">Bleedthrough matrix estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequencing.html">Gene and barcode sequencing</a></li>
<li class="toctree-l1"><a class="reference internal" href="hybridisation.html">Detecting hybridisation spots</a></li>
<li class="toctree-l1"><a class="reference internal" href="segmentation.html">Cell segmentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API reference:</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="iss_preprocess.html">iss_preprocess package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.call.html">iss_preprocess.call package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.config.html">iss_preprocess.config package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.coppafish.html">iss_preprocess.coppafish package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.image.html">iss_preprocess.image package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.io.html">iss_preprocess.io package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.pipeline.html">iss_preprocess.pipeline package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.reg.html">iss_preprocess.reg package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.segment.html">iss_preprocess.segment package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.vis.html">iss_preprocess.vis package</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="registration">
<h1>Registration<a class="headerlink" href="#registration" title="Permalink to this heading">#</a></h1>
<p>Final data is in one common coordinate system. It takes quite a few steps to get that.
This file describe how genes and barcodes are registered together.</p>
<p>TODO: integrate hyb, reference, anchor, mcherry</p>
<section id="registering-sequencing-rounds">
<h2>Registering sequencing rounds<a class="headerlink" href="#registering-sequencing-rounds" title="Permalink to this heading">#</a></h2>
<p>We need to register the channels and rounds together and the tiles with their neighbours.</p>
<section id="short-version">
<h3>Short version:<a class="headerlink" href="#short-version" title="Permalink to this heading">#</a></h3>
<p>Final transforms for channel and round registration are saved in
<code class="docutils literal notranslate"><span class="pre">&quot;reg&quot;</span> <span class="pre">/</span> <span class="pre">f&quot;tforms_corrected_{prefix}_{roi}_{tilex}_{tiley}.npz&quot;</span></code>.
The second part must be run each time.</p>
</section>
</section>
<section id="detailed-explanation-part-1-estimating-angle-scale-and-shift">
<h2>Detailed explanation part 1: Estimating angle, scale and shift<a class="headerlink" href="#detailed-explanation-part-1-estimating-angle-scale-and-shift" title="Permalink to this heading">#</a></h2>
<p>For each acquisition we need to find how the channels register together. It needs to be
done for each acquisition as the mirrors wobble a bit and the gain of the stage motor
seem to vary a bit.</p>
<section id="register-reference-tile">
<h3>Register reference tile<a class="headerlink" href="#register-reference-tile" title="Permalink to this heading">#</a></h3>
<p>We do that on a manually tile that has signal with
<code class="docutils literal notranslate"><span class="pre">iss</span> <span class="pre">register_ref_tile</span></code>.</p>
<p>This will save <code class="docutils literal notranslate"><span class="pre">f&quot;tforms_{prefix}.npz&quot;</span></code> in the main <code class="docutils literal notranslate"><span class="pre">data_folder</span></code>. The npz contains:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">angles_within_channels</span></code>: rotation angles between rounds for each channel</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shifts_within_channels</span></code>: shifts between rounds for each channel</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scales_between_channels</span></code>: scaling between channels (common for all rounds)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">angles_between_channels</span></code>: rotation angles between channels (common for all rounds)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shifts_between_channels</span></code>: shifts between channels (common for all rounds)</p></li>
</ul>
<p>To estimate these values, the algorithm first align images for each channel across rounds.
This is much more reliable than registering different channels for the same acquisition, as
the sequencing dyes have limited bleedthrough across channels. On the other hand, when aligning
between rounds, many rolonies will have the same base and therefore show up across rounds,
providing a robust signal for registration.</p>
<p>Registration is done by iterative grid search. We first search over an initial range of rotation
angles and compute phase correlation for each angle. We then determine the best angle and narrow
the search range around this value. It is important that the initial spacing between angles is
fine enough that we can find this peak. This will yield <code class="docutils literal notranslate"><span class="pre">angles_within_channels</span></code> and
<code class="docutils literal notranslate"><span class="pre">shifts_within_channels</span></code>.</p>
<p>Once we have registered together rounds for each channel, we can use the resulting angles and
shifts to compute mean and STD projections across rounds (we use the STD projections because
rolonies show up very nicely on them). These projection should capture all rolonies and will
look very similar across channels. They are provide ideal signal for registration across channels.</p>
<p>To register channels we need to correct for scaling as well as rotation due to chromatic aberration
and small differences in alignment of the tube lenses for each camera. This is done using grid search,
similar to how <code class="docutils literal notranslate"><span class="pre">angles_within_channels</span></code> are estimated. We search for the best angles and scales
while iteratively refining the search range. This will yield <code class="docutils literal notranslate"><span class="pre">scales_between_channels</span></code>,
<code class="docutils literal notranslate"><span class="pre">angles_between_channels</span></code>, and <code class="docutils literal notranslate"><span class="pre">shifts_between_channels</span></code>.</p>
</section>
<section id="estimate-for-all-tiles">
<h3>Estimate for all tiles<a class="headerlink" href="#estimate-for-all-tiles" title="Permalink to this heading">#</a></h3>
<p>We can then use the parameters estimated for the reference tile to register all tiles with
<code class="docutils literal notranslate"><span class="pre">iss</span> <span class="pre">estimate-shifts</span></code>. This is necessary for two reasons. First, dichroic wobble slightly
during and between acquisitions resulting in different shifts between channels. Second, the
gain of the microscope stage seems to vary from day to day. Therefore, the microscope does not
consistently move to the same position for each tile from round to round, resulting in different
shifts across rounds. Therefore, we will re-estimate shifts, both within and across channel,
but will <strong>not</strong> change <code class="docutils literal notranslate"><span class="pre">angles_within_channels</span></code>, <code class="docutils literal notranslate"><span class="pre">angles_between_channels</span></code> and
<code class="docutils literal notranslate"><span class="pre">scales_between_channels</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">angles_within_channels</span></code> and <code class="docutils literal notranslate"><span class="pre">angles_across_channels</span></code> might actually vary due to the
dichroic wobble but in practice registration works well using values from the reference tile.</p>
</div>
<p>The output is saved in the <cite>reg</cite> subfolder as
<code class="docutils literal notranslate"><span class="pre">f&quot;tforms_{prefix}_{roi}_{tilex}_{tiley}.npz&quot;</span></code></p>
</section>
<section id="final-shift-correction">
<h3>Final shift correction<a class="headerlink" href="#final-shift-correction" title="Permalink to this heading">#</a></h3>
<p>The single tile estimation tends to fail sporadically if there is not enough signal. This
can be corrected given that the main change of shifts from tile to tile is a linear
function of X and Y (probably due to change in gain of the stage). We do that with
RANSAC robust regression in <code class="docutils literal notranslate"><span class="pre">iss</span> <span class="pre">correct-shifts</span></code>. Once again, this does <strong>not</strong>
re-estimate angles and scale changes, just shifts.</p>
<p>The output is saved in the <code class="docutils literal notranslate"><span class="pre">reg</span></code> folder as
<code class="docutils literal notranslate"><span class="pre">f&quot;tforms_corrected_{prefix}_{roi}_{tilex}_{tiley}.npz&quot;</span></code></p>
</section>
</section>
<section id="detailed-explanation-part-2-stitching-tiles">
<h2>Detailed explanation part 2: Stitching tiles<a class="headerlink" href="#detailed-explanation-part-2-stitching-tiles" title="Permalink to this heading">#</a></h2>
<p>The information computed above allows us to load all tiles in their “acquisition”
coordinates (same for all tiles of one prefix, but different across prefixes).</p>
<section id="find-tile-shifts">
<h3>Find tile shifts<a class="headerlink" href="#find-tile-shifts" title="Permalink to this heading">#</a></h3>
<p>We estimate how much overlap there is between tiles (and therefore how much we need
to shift them to merge) by phase correlation. This also takes into account that the
cameras may not be perfectly aligned with the stage, therefore there might be
(and usually will be) a shift in both X and Y between both rows and columns.</p>
<p>This is done by calling:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shift_right</span><span class="p">,</span> <span class="n">shift_down</span><span class="p">,</span> <span class="n">tile_shape</span> <span class="o">=</span> <span class="n">iss</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">register_adjacent_tiles</span><span class="p">(</span>
    <span class="n">data_path</span><span class="p">,</span> <span class="n">ref_coors</span><span class="o">=</span><span class="n">ops</span><span class="p">[</span><span class="s1">&#39;ref_tile&#39;</span><span class="p">],</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;genes_round_1_1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The output is currently not saved.</p>
</section>
<section id="merge-coordinates">
<h3>Merge coordinates<a class="headerlink" href="#merge-coordinates" title="Permalink to this heading">#</a></h3>
<p>With these tile shift we can find the position of each tile, simply by multiplying the
tile number by the shift.</p>
<p>This can be done with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">roi_dims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">processed_path</span> <span class="o">/</span> <span class="n">data_path</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">_roi_dims.npy&quot;</span><span class="p">)</span>
<span class="n">ntiles</span> <span class="o">=</span> <span class="n">roi_dims</span><span class="p">[</span><span class="n">roi_dims</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">tile_origins</span><span class="p">,</span> <span class="n">tile_centers</span> <span class="o">=</span> <span class="n">iss</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">calculate_tile_positions</span><span class="p">(</span>
        <span class="n">shift_right</span><span class="p">,</span> <span class="n">shift_down</span><span class="p">,</span> <span class="n">tile_shape</span><span class="p">,</span> <span class="n">ntiles</span><span class="p">)</span>
</pre></div>
</div>
<p>The output is currently not saved.</p>
</section>
</section>
<section id="registering-acquisition-together">
<h2>Registering acquisition together<a class="headerlink" href="#registering-acquisition-together" title="Permalink to this heading">#</a></h2>
<p>The final reference coordinate is (for now) <code class="docutils literal notranslate"><span class="pre">genes_round</span></code>. We can register each
acquisition independantly first. Then we want to merge them. To do that we generate
a downsampled stitched image of the reference acquisition and the acquisition we want
to register.</p>
<p>This is done for raw images with <code class="docutils literal notranslate"><span class="pre">iss.pipeline.stitch_and_register</span></code>. It returns the
two registered mosaic at full resolution as well as the transformation parameter: shift
and angle.</p>
<p>This output is not saved for now.</p>
<p>For spots, the same function is called by <code class="docutils literal notranslate"><span class="pre">iss</span> <span class="pre">align-spots</span></code></p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="correction.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Channel brightness and illumination correction</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Znamenskiy lab
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Registration</a><ul>
<li><a class="reference internal" href="#registering-sequencing-rounds">Registering sequencing rounds</a><ul>
<li><a class="reference internal" href="#short-version">Short version:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#detailed-explanation-part-1-estimating-angle-scale-and-shift">Detailed explanation part 1: Estimating angle, scale and shift</a><ul>
<li><a class="reference internal" href="#register-reference-tile">Register reference tile</a></li>
<li><a class="reference internal" href="#estimate-for-all-tiles">Estimate for all tiles</a></li>
<li><a class="reference internal" href="#final-shift-correction">Final shift correction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#detailed-explanation-part-2-stitching-tiles">Detailed explanation part 2: Stitching tiles</a><ul>
<li><a class="reference internal" href="#find-tile-shifts">Find tile shifts</a></li>
<li><a class="reference internal" href="#merge-coordinates">Merge coordinates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#registering-acquisition-together">Registering acquisition together</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>