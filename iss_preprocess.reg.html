<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="iss_preprocess.segment package" href="iss_preprocess.segment.html" /><link rel="prev" title="iss_preprocess.pipeline package" href="iss_preprocess.pipeline.html" />

    <!-- Generated with Sphinx 6.1.3 and Furo 2022.12.07 -->
        <title>iss_preprocess.reg package - iss-preprocess 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">iss-preprocess 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">iss-preprocess 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="correction.html">Channel brightness and illumination correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="bleedthrough.html">Bleedthrough matrix estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequencing.html">Gene and barcode sequencing</a></li>
<li class="toctree-l1"><a class="reference internal" href="hybridisation.html">Detecting hybridisation spots</a></li>
<li class="toctree-l1"><a class="reference internal" href="segmentation.html">Cell segmentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API reference:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="iss_preprocess.html">iss_preprocess package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.call.html">iss_preprocess.call package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.config.html">iss_preprocess.config package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.coppafish.html">iss_preprocess.coppafish package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.image.html">iss_preprocess.image package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.io.html">iss_preprocess.io package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.pipeline.html">iss_preprocess.pipeline package</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">iss_preprocess.reg package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.segment.html">iss_preprocess.segment package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iss_preprocess.vis.html">iss_preprocess.vis package</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="iss-preprocess-reg-package">
<h1>iss_preprocess.reg package<a class="headerlink" href="#iss-preprocess-reg-package" title="Permalink to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-iss_preprocess.reg.rounds_and_channels">
<span id="iss-preprocess-reg-rounds-and-channels-module"></span><h2>iss_preprocess.reg.rounds_and_channels module<a class="headerlink" href="#module-iss_preprocess.reg.rounds_and_channels" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.rounds_and_channels.align_channels_and_rounds">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.rounds_and_channels.</span></span><span class="sig-name descname"><span class="pre">align_channels_and_rounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tforms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.rounds_and_channels.align_channels_and_rounds" title="Permalink to this definition">#</a></dt>
<dd><p>Apply the provided transformations to align images across channels and rounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<em>np.array</em>) – X x Y x Nchannels x Nrounds images stack</p></li>
<li><p><strong>tforms</strong> (<em>np.array</em>) – Nch x Nrounds array of transformation matrices (each 3x3)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aligned stack with NaN for missing pixels. Same shape as input stack</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.rounds_and_channels.align_within_channels">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.rounds_and_channels.</span></span><span class="sig-name descname"><span class="pre">align_within_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_round</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nangles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.rounds_and_channels.align_within_channels" title="Permalink to this definition">#</a></dt>
<dd><p>Align images within each channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<em>np.array</em>) – X x Y x Nchannels x Nrounds images stack</p></li>
<li><p><strong>upsample</strong> (<em>bool</em><em>, or </em><em>int</em>) – whether to use subpixel registration, and if so, how much
to upsample</p></li>
<li><p><strong>ref_round</strong> (<em>int</em>) – round to align to</p></li>
<li><p><strong>angle_range</strong> (<em>float</em>) – range of angles to search for each round</p></li>
<li><p><strong>niter</strong> (<em>int</em>) – number of iterations to run</p></li>
<li><p><strong>nangles</strong> (<em>int</em>) – number of angles to search for each iteration</p></li>
<li><p><strong>min_shift</strong> (<em>int</em>) – minimum shift. Necessary to avoid spurious cross-correlations
for images acquired from the same camera</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nchannels x Nrounds array of angles
shifts (np.array): Nchannels x Nrounds x 2 array of shifts</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>angles (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.rounds_and_channels.apply_corrections">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.rounds_and_channels.</span></span><span class="sig-name descname"><span class="pre">apply_corrections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.rounds_and_channels.apply_corrections" title="Permalink to this definition">#</a></dt>
<dd><p>Apply scale, rotation and shift corrections to a multichannel image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im</strong> (<em>np.array</em>) – X x Y x Nchannels image</p></li>
<li><p><strong>scales</strong> (<em>np.array</em>) – Nchannels array of scale factors</p></li>
<li><p><strong>angles</strong> (<em>np.array</em>) – Nchannels array of angles</p></li>
<li><p><strong>shifts</strong> (<em>np.array</em>) – Nchannels x 2 array of shifts</p></li>
<li><p><strong>cval</strong> (<em>float</em>) – value to fill empty pixels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>X x Y x Nchannels registered image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>im_reg (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.rounds_and_channels.estimate_correction">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.rounds_and_channels.</span></span><span class="sig-name descname"><span class="pre">estimate_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch_to_align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nangles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.rounds_and_channels.estimate_correction" title="Permalink to this definition">#</a></dt>
<dd><p>Estimate scale, rotation and translation corrections for each channel of a multichannel image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im</strong> (<em>np.array</em>) – X x Y x Nchannels image</p></li>
<li><p><strong>ch_to_align</strong> (<em>int</em>) – channel to align to</p></li>
<li><p><strong>upsample</strong> (<em>bool</em><em>, or </em><em>int</em>) – whether to upsample the image, and if so but what factor</p></li>
<li><p><strong>scale_range</strong> (<em>float</em>) – range of scale factors to search through</p></li>
<li><p><strong>nangles</strong> (<em>int</em>) – number of angles to search through</p></li>
<li><p><strong>niter</strong> (<em>int</em>) – number of iterations to run</p></li>
<li><p><strong>angle_range</strong> (<em>float</em>) – range of angles to search through</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nchannels array of scale factors
angles (np.array): Nchannels array of angles
shifts (np.array): Nchannels x 2 array of shifts</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scales (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.rounds_and_channels.estimate_rotation_angle">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.rounds_and_channels.</span></span><span class="sig-name descname"><span class="pre">estimate_rotation_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_fft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nangles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.rounds_and_channels.estimate_rotation_angle" title="Permalink to this definition">#</a></dt>
<dd><p>Estimate rotation angle that maximizes phase correlation between the target and the
reference image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference_fft</strong> (<em>numpy.ndarray</em>) – X x Y reference image in Fourier domain</p></li>
<li><p><strong>target</strong> (<em>numpy.ndarray</em>) – X x Y target image</p></li>
<li><p><strong>angle_range</strong> (<em>float</em>) – range of angles in degrees to search over</p></li>
<li><p><strong>best_angle</strong> (<em>float</em>) – initial angle in degrees</p></li>
<li><p><strong>nangles</strong> (<em>int</em>) – number of angles to try</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>best_angle (float) in degrees
max_cc (float) maximum cross correlation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.rounds_and_channels.estimate_rotation_translation">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.rounds_and_channels.</span></span><span class="sig-name descname"><span class="pre">estimate_rotation_translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nangles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_range_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.rounds_and_channels.estimate_rotation_translation" title="Permalink to this definition">#</a></dt>
<dd><p>Estimate rotation and translation that maximizes phase correlation between the target and the
reference image. Search for the best angle is performed iteratively by decreasing the gradually
searching over small and smaller angle range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference</strong> (<em>numpy.ndarray</em>) – X x Y reference image</p></li>
<li><p><strong>target</strong> (<em>numpy.ndarray</em>) – X x Y target image</p></li>
<li><p><strong>angle_range</strong> (<em>float</em>) – initial range of angles in degrees to search over</p></li>
<li><p><strong>niter</strong> (<em>int</em>) – number of iterations to refine rotation angle</p></li>
<li><p><strong>nangles</strong> (<em>int</em>) – number of angles to try on each iteration</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – whether to print progress of registration</p></li>
<li><p><strong>iter_range_factor</strong> (<em>float</em>) – how much to shrink the angle range for each
iteration. Default: 5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>best_angle (float) in degrees
shift (tuple) of X and Y shifts</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.rounds_and_channels.estimate_scale_rotation_translation">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.rounds_and_channels.</span></span><span class="sig-name descname"><span class="pre">estimate_scale_rotation_translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nscales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nangles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.rounds_and_channels.estimate_scale_rotation_translation" title="Permalink to this definition">#</a></dt>
<dd><p>Estimate rotation and translation that maximizes phase correlation between the target and the
reference image. Search for the best angle is performed iteratively by gradually
searching over small and smaller angle range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference</strong> (<em>numpy.ndarray</em>) – X x Y reference image</p></li>
<li><p><strong>target</strong> (<em>numpy.ndarray</em>) – X x Y target image</p></li>
<li><p><strong>angle_range</strong> (<em>float</em>) – initial range of angles in degrees to search over</p></li>
<li><p><strong>niter</strong> (<em>int</em>) – number of iterations to refine rotation angle</p></li>
<li><p><strong>nangles</strong> (<em>int</em>) – number of angles to try on each iteration</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – whether to print progress of registration</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – how to rescale image for finding the optimal rotation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>best_angle (float) in degrees
shift (tuple) of X and Y shifts</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.rounds_and_channels.estimate_shifts_and_angles_for_tile">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.rounds_and_channels.</span></span><span class="sig-name descname"><span class="pre">estimate_shifts_and_angles_for_tile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_ch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_quantile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.rounds_and_channels.estimate_shifts_and_angles_for_tile" title="Permalink to this definition">#</a></dt>
<dd><p>Estimate shifts and angles. Registration is carried out on thresholded images
using the provided quantile threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<em>np.array</em>) – X x Y x Nchannels images stack</p></li>
<li><p><strong>scales</strong> (<em>np.array</em>) – Nchannels array of scales</p></li>
<li><p><strong>ref_ch</strong> (<em>int</em>) – reference channel</p></li>
<li><p><strong>threshold_quantile</strong> (<em>float</em>) – quantile to use for thresholding</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nchannels array of angles
shifts (np.array): Nchannels x 2 array of shifts</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>angles (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.rounds_and_channels.estimate_shifts_for_tile">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.rounds_and_channels.</span></span><span class="sig-name descname"><span class="pre">estimate_shifts_for_tile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles_within_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales_between_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles_between_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_ch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_round</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.rounds_and_channels.estimate_shifts_for_tile" title="Permalink to this definition">#</a></dt>
<dd><p>Use precomputed rotations and scale factors to re-estimate shifts for every round and between channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<em>np.array</em>) – X x Y x Nchannels x Nrounds images stack</p></li>
<li><p><strong>angles_within_channels</strong> (<em>np.array</em>) – Nchannels x Nrounds array of angles</p></li>
<li><p><strong>scales_between_channels</strong> (<em>np.array</em>) – Nchannels x Nchannels array of scale factors</p></li>
<li><p><strong>angles_between_channels</strong> (<em>np.array</em>) – Nchannels x Nchannels array of angles</p></li>
<li><p><strong>ref_ch</strong> (<em>int</em>) – reference channel</p></li>
<li><p><strong>ref_round</strong> (<em>int</em>) – reference round</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nchannels x Nrounds x 2 array of shifts
shifts_between_channels (np.array): Nchannels x Nchannels x 2 array of shifts</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>shifts_within_channels (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.rounds_and_channels.generate_channel_round_transforms">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.rounds_and_channels.</span></span><span class="sig-name descname"><span class="pre">generate_channel_round_transforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles_within_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts_within_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales_between_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles_between_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts_between_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.rounds_and_channels.generate_channel_round_transforms" title="Permalink to this definition">#</a></dt>
<dd><p>Generate transformation matrices for each channel and round.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angles_within_channels</strong> (<em>np.array</em>) – Nchannels x Nrounds array of angles</p></li>
<li><p><strong>shifts_within_channels</strong> (<em>np.array</em>) – Nchannels x Nrounds x 2 array of shifts</p></li>
<li><p><strong>scales_between_channels</strong> (<em>np.array</em>) – Nchannels array of scales</p></li>
<li><p><strong>angles_between_channels</strong> (<em>np.array</em>) – Nchannels array of angles</p></li>
<li><p><strong>shifts_between_channels</strong> (<em>np.array</em>) – Nchannels x 2 array of shifts</p></li>
<li><p><strong>stack_shape</strong> (<em>tuple</em>) – shape of the stack</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nch x Nrounds array of transformation matrices (each 3x3)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.rounds_and_channels.get_channel_reference_images">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.rounds_and_channels.</span></span><span class="sig-name descname"><span class="pre">get_channel_reference_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts_channels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.rounds_and_channels.get_channel_reference_images" title="Permalink to this definition">#</a></dt>
<dd><p>Get reference images for each channel from STD or mean projection after registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<em>np.array</em>) – X x Y x Nchannels x Nrounds images stack</p></li>
<li><p><strong>angles_channels</strong> (<em>np.array</em>) – Nchannels x Nrounds array of angles</p></li>
<li><p><strong>shifts_channels</strong> (<em>np.array</em>) – Nchannels x Nrounds x 2 array of shifts</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>X x Y x Nchannels std projections
mean_stack (np.array): X x Y x Nchannels mean projections</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>std_stack (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.rounds_and_channels.register_channels_and_rounds">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.rounds_and_channels.</span></span><span class="sig-name descname"><span class="pre">register_channels_and_rounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_ch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_round</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.rounds_and_channels.register_channels_and_rounds" title="Permalink to this definition">#</a></dt>
<dd><p>Estimate transformation matrices for alignment across channels and rounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> – X x Y x Nchannels x Nrounds images stack</p></li>
<li><p><strong>ref_ch</strong> (<em>int</em>) – channel to align to</p></li>
<li><p><strong>ref_round</strong> (<em>int</em>) – round to align to</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nchannels x Nrounds array of angles
shifts_within_channels (np.array): Nchannels x Nrounds x 2 array of shifts
scales_between_channels (np.array): Nchannels array of scales
angles_between_channels (np.array): Nchannels array of angles
shifts_between_channels (np.array): Nchannels x 2 array of shifts</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>angles_within_channels (np.array)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-iss_preprocess.reg.util">
<span id="iss-preprocess-reg-util-module"></span><h2>iss_preprocess.reg.util module<a class="headerlink" href="#module-iss_preprocess.reg.util" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.util.make_transform">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.util.</span></span><span class="sig-name descname"><span class="pre">make_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.util.make_transform" title="Permalink to this definition">#</a></dt>
<dd><p>Make a transformation matrix using provided scale, rotation angle, and shift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>float</em>) – scale factor</p></li>
<li><p><strong>angle</strong> (<em>float</em>) – rotation angle in degrees</p></li>
<li><p><strong>shift</strong> (<em>tuple</em>) – shift in x and y</p></li>
<li><p><strong>shape</strong> (<em>tuple</em>) – shape of the image</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>transformation matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.util.phase_corr">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.util.</span></span><span class="sig-name descname"><span class="pre">phase_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whiten</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#iss_preprocess.reg.util.phase_corr" title="Permalink to this definition">#</a></dt>
<dd><p>Compute phase correlation of two images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference</strong> (<em>numpy.ndarray</em>) – reference image</p></li>
<li><p><strong>target</strong> (<em>numpy.ndarray</em>) – target image</p></li>
<li><p><strong>max_shift</strong> (<em>int</em>) – the range over which to search for the maximum of the
cross-correlogram</p></li>
<li><p><strong>whiten</strong> (<em>bool</em>) – whether or not to whiten the FFTs of the images. If True,
the method performs phase correlation, otherwise cross correlation</p></li>
<li><p><strong>fft_ref</strong> (<em>bool</em>) – whether to compute the FFT transform of the reference</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array of the location of the peak of the cross-correlogram
cc: numpy.ndarray of the cross-correlagram itself.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>shift</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iss_preprocess.reg.util.transform_image">
<span class="sig-prename descclassname"><span class="pre">iss_preprocess.reg.util.</span></span><span class="sig-name descname"><span class="pre">transform_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iss_preprocess.reg.util.transform_image" title="Permalink to this definition">#</a></dt>
<dd><p>Transform an image using provided scale, rotation angle, and shift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im</strong> (<em>numpy.ndarray</em>) – image to transform</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – scale factor</p></li>
<li><p><strong>angle</strong> (<em>float</em>) – rotation angle in degrees</p></li>
<li><p><strong>shift</strong> (<em>tuple</em>) – shift in x and y</p></li>
<li><p><strong>cval</strong> (<em>float</em>) – value to fill in for pixels outside of the image</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>transformed image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-iss_preprocess.reg">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-iss_preprocess.reg" title="Permalink to this heading">#</a></h2>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="iss_preprocess.segment.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">iss_preprocess.segment package</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="iss_preprocess.pipeline.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">iss_preprocess.pipeline package</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Znamenskiy lab
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">iss_preprocess.reg package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-iss_preprocess.reg.rounds_and_channels">iss_preprocess.reg.rounds_and_channels module</a><ul>
<li><a class="reference internal" href="#iss_preprocess.reg.rounds_and_channels.align_channels_and_rounds"><code class="docutils literal notranslate"><span class="pre">align_channels_and_rounds()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.rounds_and_channels.align_within_channels"><code class="docutils literal notranslate"><span class="pre">align_within_channels()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.rounds_and_channels.apply_corrections"><code class="docutils literal notranslate"><span class="pre">apply_corrections()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.rounds_and_channels.estimate_correction"><code class="docutils literal notranslate"><span class="pre">estimate_correction()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.rounds_and_channels.estimate_rotation_angle"><code class="docutils literal notranslate"><span class="pre">estimate_rotation_angle()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.rounds_and_channels.estimate_rotation_translation"><code class="docutils literal notranslate"><span class="pre">estimate_rotation_translation()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.rounds_and_channels.estimate_scale_rotation_translation"><code class="docutils literal notranslate"><span class="pre">estimate_scale_rotation_translation()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.rounds_and_channels.estimate_shifts_and_angles_for_tile"><code class="docutils literal notranslate"><span class="pre">estimate_shifts_and_angles_for_tile()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.rounds_and_channels.estimate_shifts_for_tile"><code class="docutils literal notranslate"><span class="pre">estimate_shifts_for_tile()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.rounds_and_channels.generate_channel_round_transforms"><code class="docutils literal notranslate"><span class="pre">generate_channel_round_transforms()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.rounds_and_channels.get_channel_reference_images"><code class="docutils literal notranslate"><span class="pre">get_channel_reference_images()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.rounds_and_channels.register_channels_and_rounds"><code class="docutils literal notranslate"><span class="pre">register_channels_and_rounds()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-iss_preprocess.reg.util">iss_preprocess.reg.util module</a><ul>
<li><a class="reference internal" href="#iss_preprocess.reg.util.make_transform"><code class="docutils literal notranslate"><span class="pre">make_transform()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.util.phase_corr"><code class="docutils literal notranslate"><span class="pre">phase_corr()</span></code></a></li>
<li><a class="reference internal" href="#iss_preprocess.reg.util.transform_image"><code class="docutils literal notranslate"><span class="pre">transform_image()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-iss_preprocess.reg">Module contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>