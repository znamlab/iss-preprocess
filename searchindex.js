Search.setIndex({"docnames": ["bleedthrough", "correction", "hybridisation", "index", "iss_preprocess", "iss_preprocess.call", "iss_preprocess.config", "iss_preprocess.coppafish", "iss_preprocess.image", "iss_preprocess.io", "iss_preprocess.pipeline", "iss_preprocess.reg", "iss_preprocess.segment", "iss_preprocess.vis", "modules", "registration", "segmentation", "sequencing"], "filenames": ["bleedthrough.rst", "correction.rst", "hybridisation.rst", "index.rst", "iss_preprocess.rst", "iss_preprocess.call.rst", "iss_preprocess.config.rst", "iss_preprocess.coppafish.rst", "iss_preprocess.image.rst", "iss_preprocess.io.rst", "iss_preprocess.pipeline.rst", "iss_preprocess.reg.rst", "iss_preprocess.segment.rst", "iss_preprocess.vis.rst", "modules.rst", "registration.rst", "segmentation.rst", "sequencing.rst"], "titles": ["Bleedthrough matrix estimation", "Channel brightness and illumination correction", "Detecting hybridisation spots", "Welcome to iss-preprocess\u2019s documentation!", "iss_preprocess package", "iss_preprocess.call package", "iss_preprocess.config package", "iss_preprocess.coppafish package", "iss_preprocess.image package", "iss_preprocess.io package", "iss_preprocess.pipeline package", "iss_preprocess.reg package", "iss_preprocess.segment package", "iss_preprocess.vis package", "iss_preprocess", "Registration", "Cell segmentation", "Gene and barcode sequencing"], "terms": {"registr": [3, 10, 11, 13], "regist": [3, 4, 11, 14], "sequenc": [3, 4, 5, 13, 14], "round": [3, 5, 8, 9, 10, 11, 12, 13], "detail": [3, 9], "explan": 3, "part": 3, "1": [3, 5, 7, 8, 9, 10, 11, 12, 13], "estim": [3, 5, 7, 10, 11, 13], "angl": [3, 10, 11], "scale": [3, 10, 11], "shift": [3, 5, 10, 11, 13], "2": [3, 5, 7, 8, 10, 11, 12, 13], "stitch": [3, 4, 13, 14], "tile": [3, 8, 9, 10, 13], "acquisit": [3, 9, 10, 13], "togeth": [3, 5], "channel": [3, 5, 8, 9, 10, 11, 12, 13, 15], "bright": [3, 8, 10], "illumin": [3, 8, 10, 13], "correct": [3, 4, 10, 11, 13, 14], "bleedthrough": [3, 5, 10, 15], "matrix": [3, 5, 7, 10, 11, 13], "gene": [3, 5, 10, 12, 13, 15], "barcod": [3, 4, 5, 10, 14, 15], "detect": [3, 5, 10, 12, 13], "decod": 3, "spot": [3, 4, 5, 7, 10, 13, 14, 15], "basecal": [3, 5, 10], "hybridis": [3, 4, 9, 14], "cell": [3, 4, 10, 14], "segment": [3, 4, 14], "iss_preprocess": 3, "packag": [3, 14], "call": [3, 4, 10, 14, 15], "config": [3, 4, 9, 14], "coppafish": [3, 4, 8, 14], "imag": [3, 4, 5, 7, 9, 10, 11, 12, 13, 14, 15], "io": [3, 4, 10, 14], "reg": [3, 4, 10, 14, 15], "vi": [3, 4, 5, 10, 14], "submodul": [3, 14], "cli": [3, 14], "modul": [3, 14], "util": [3, 4, 14], "import": [3, 15], "localis": 3, "base": [3, 5, 8, 10, 12, 13, 15], "data": [3, 5, 7, 8, 9, 10, 12, 13, 15], "set": [3, 7, 10], "first": [3, 5, 7, 8, 9, 10, 15], "clone": 3, "git": 3, "github": 3, "com": [3, 7], "znamlab": 3, "next": 3, "navig": 3, "repo": [3, 10], "directori": [3, 8, 10], "creat": [3, 5, 8, 9, 10, 13], "conda": 3, "environ": [3, 10], "depend": 3, "run": [3, 5, 10, 11, 15], "env": 3, "name": [3, 5, 8, 9, 10, 12, 13], "python": 3, "3": [3, 8, 9, 10, 11, 12, 13], "10": [3, 7, 10, 12], "final": [3, 7], "activ": 3, "new": [3, 5, 7, 10], "itself": [3, 11], "pip": 3, "e": [3, 5, 8, 10], "To": [3, 5, 10, 15], "build": [3, 7], "you": 3, "also": [3, 5, 10, 15], "need": [3, 5, 10, 15], "sphinx": 3, "furo": 3, "m2r2": 3, "The": [3, 5, 8, 9, 10, 15], "allen": 3, "us": [3, 5, 7, 8, 9, 10, 11, 12, 13, 15], "bg_atlasapi": 3, "from": [3, 5, 7, 8, 9, 10, 11, 12, 15], "brainglob": 3, "keep": [3, 10, 12], "version": [3, 10], "default": [3, 5, 8, 9, 10, 11, 12, 13], "can": [3, 7, 9, 10, 12, 15], "quit": [3, 15], "big": 3, "high": 3, "resolut": [3, 10, 15], "atlas": 3, "10um": 3, "per": [3, 5, 10, 13], "pixel": [3, 5, 7, 8, 9, 10, 11, 12, 13], "If": [3, 5, 7, 8, 9, 10, 11, 12, 13], "nemo": 3, "might": [3, 10, 15], "consid": [3, 5, 12], "link": 3, "folder": [3, 9, 10, 15], "save": [3, 4, 10, 13, 14, 15], "space": [3, 15], "your": 3, "home": 3, "mkdir": 3, "camp": 3, "lab": 3, "znamenskiyp": 3, "user": [3, 9], "ln": 3, "purpos": 3, "i": [3, 5, 7, 8, 9, 10, 11, 12, 13, 15], "hous": 3, "script": [3, 10], "multipl": [3, 9], "flavour": 3, "barseq": 3, "instaseq": 3, "etc": [3, 9], "broad": 3, "stroke": 3, "ar": [3, 5, 7, 8, 9, 10, 12, 15], "between": [3, 5, 7, 10, 11, 13, 15], "matric": [3, 10, 11, 13], "across": [3, 5, 10, 11, 15], "each": [3, 5, 7, 8, 9, 10, 11, 12, 13, 15], "align": [3, 10, 11, 15], "global": [3, 10], "coordin": [3, 5, 9, 10], "system": [3, 15], "dapi": 3, "construct": 3, "input": [3, 5, 8, 11], "relat": 3, "metadata": [3, 9, 10], "code": [3, 5], "process": [3, 9, 10], "routin": 3, "roi": [3, 4, 5, 9, 10, 13, 14, 15], "roloni": [3, 10, 12, 15], "output": [3, 5, 9, 10, 12, 15], "contain": [3, 5, 8, 9, 10, 13, 15], "adapt": [3, 7], "codebas": 3, "han": [3, 7, 8, 10], "window": [3, 7, 8], "annulu": [3, 4, 7, 12], "isol": [3, 7, 10, 12], "k": [3, 8, 10], "mean": [3, 5, 7, 8, 10, 11, 15], "level": [3, 8, 9, 10, 13], "batch": [3, 10], "orthogon": [3, 5], "match": [3, 5], "pursuit": [3, 5], "identifi": [3, 5, 10], "approach": [3, 5], "loos": 3, "preprint": 3, "http": [3, 7], "www": [3, 7], "biorxiv": 3, "org": 3, "1101": 3, "2021": 3, "24": 3, "465600v4": 3, "implement": 3, "jduffield65": 3, "look": [3, 10, 13, 15], "std": [3, 10, 11, 15], "project": [3, 4, 11, 14, 15], "averag": [3, 5, 8, 10, 12, 13], "fluoresc": [3, 5, 10], "fed": 3, "simpl": [3, 8], "caller": 3, "which": [3, 5, 7, 9, 10, 11], "gaussian": [3, 5, 8, 10, 12], "mixtur": [3, 5], "model": [3, 5, 12], "classifi": 3, "4": [3, 5, 8, 10, 12, 13], "them": [3, 5, 8, 10, 15], "compar": [3, 10], "codebook": [3, 5], "assign": [3, 5, 7, 12], "without": [3, 10], "ani": 3, "mismatch": 3, "dictionari": [3, 5, 10, 12, 13], "appli": [3, 5, 8, 10, 11], "present": [3, 5], "algorithm": [3, 5, 10, 15], "work": [3, 5, 10, 15], "iter": [3, 5, 7, 10, 11, 15], "At": [3, 5], "step": [3, 5, 10, 15], "we": [3, 5, 10, 12, 15], "find": [3, 5, 8, 9, 10, 11, 12], "compon": [3, 5], "ha": [3, 5, 10, 15], "highest": [3, 5, 10], "dot": [3, 5, 7, 10], "product": [3, 5, 7, 10], "residu": [3, 5], "signal": [3, 5, 15], "after": [3, 5, 8, 10, 11, 13], "select": [3, 5, 12], "coeffici": [3, 5], "all": [3, 5, 7, 8, 9, 10, 12], "includ": [3, 5, 9, 10, 12], "least": [3, 5], "squar": [3, 5, 10], "regress": [3, 5, 10, 15], "updat": [3, 5], "retain": [3, 5], "reduc": [3, 5, 8], "norm": [3, 5, 7, 10], "fraction": [3, 5, 10], "origin": [3, 5, 10], "specifi": [3, 5, 10], "toler": [3, 5], "paramet": [3, 5, 7, 8, 9, 10, 11, 12, 13, 15], "end": 3, "seri": 3, "now": [3, 15], "peak": [3, 5, 11, 12, 15], "locat": [3, 10, 11, 12, 13], "individu": [3, 10, 12], "found": [3, 9], "notebook": 3, "subdirectori": 3, "index": [3, 7, 10], "search": [3, 10, 11, 15], "page": 3, "basecall_roi": [4, 5], "call_gen": [4, 5], "correct_barcode_sequ": [4, 5], "extract_spot": [4, 5], "get_cluster_mean": [4, 5, 10], "rois_to_arrai": [4, 5], "omp": [4, 10, 14], "barcode_spots_dot_product": [4, 5], "make_background_vector": [4, 5], "make_gene_templ": [4, 5], "omp_weight": [4, 5], "refine_gene_templ": [4, 5], "run_omp": [4, 5], "spot_shap": [4, 14], "apply_symmetri": [4, 5], "detect_spots_by_shap": [4, 5], "find_gene_spot": [4, 5], "get_spot_shap": [4, 5], "default_op": [4, 14], "ftrans2": [4, 7], "hanning_diff": [4, 7], "scaled_k_mean": [4, 5, 7], "apply_illumination_correct": [4, 8], "compute_distribut": [4, 8], "filter_stack": [4, 8], "tilestats_and_mean_imag": [4, 8], "fstack": [4, 9, 10, 14], "fstack_channel": [4, 8], "gauss3p": [4, 8], "gfocu": [4, 8], "load": [4, 8, 10, 14, 15], "get_pixel_s": [4, 9], "get_roi_dimens": [4, 9], "get_tile_om": [4, 9], "load_hyb_probes_metadata": [4, 9], "load_metadata": [4, 9], "load_micromanager_metadata": [4, 9], "load_op": [4, 9], "load_section_posit": [4, 9], "load_stack": [4, 9], "load_tile_by_coor": [4, 9], "save_ome_tiff_pyramid": [4, 9], "write_stack": [4, 9], "pipelin": [4, 13, 14, 15], "ara_registr": [4, 14], "find_roi_position_on_cryostat": [4, 10], "load_coordinate_imag": [4, 10], "load_registration_reference_metadata": [4, 10], "make_area_imag": [4, 10], "overview_single_roi": [4, 10], "spots_ara_info": [4, 10], "diagnost": [4, 14], "check_illumination_correct": [4, 10], "check_spot_sign_imag": [4, 10], "reg_to_ref_estim": [4, 10], "estimate_channel_correction_hybridis": [4, 10], "extract_hyb_spots_al": [4, 10], "extract_hyb_spots_roi": [4, 10], "extract_hyb_spots_til": [4, 10], "hyb_spot_cluster_mean": [4, 10], "load_and_register_hyb_til": [4, 10], "setup_hyb_spot_cal": [4, 10], "batch_process_til": [4, 10], "create_all_single_averag": [4, 10], "create_grand_averag": [4, 10], "create_single_averag": [4, 10], "load_and_register_til": [4, 10], "overview_for_ara_registr": [4, 10], "check_project": [4, 10], "project_round": [4, 10], "project_til": [4, 10], "project_tile_by_coor": [4, 10], "project_tile_row": [4, 10], "align_spot": [4, 10], "correct_hyb_shift": [4, 10], "correct_shift": [4, 10], "correct_shifts_roi": [4, 10], "correct_shifts_single_round_roi": [4, 10], "correct_shifts_to_ref": [4, 10], "estimate_shifts_and_angles_by_coor": [4, 10], "estimate_shifts_by_coor": [4, 10], "register_reference_til": [4, 10], "register_tile_to_ref": [4, 10], "add_mask_id": [4, 10], "make_cell_datafram": [4, 10], "segment_all_roi": [4, 10], "segment_roi": [4, 10], "segment_spot": [4, 10], "basecall_til": [4, 10], "compute_spot_sign_imag": [4, 10], "detect_genes_on_til": [4, 10], "estimate_channel_correct": [4, 10], "load_and_register_sequencing_til": [4, 10], "load_sequencing_round": [4, 10], "load_spot_sign_imag": [4, 10], "run_omp_on_til": [4, 10], "setup_barcode_cal": [4, 10], "setup_omp": [4, 10], "calculate_tile_posit": [4, 10, 15], "get_tile_corn": [4, 10], "load_tile_ref_coor": [4, 10], "merge_and_align_spot": [4, 10], "merge_and_align_spots_all_roi": [4, 10], "merge_roi_spot": [4, 10], "register_adjacent_til": [4, 10, 15], "register_within_acquisit": [4, 10, 13], "stitch_and_regist": [4, 10, 15], "stitch_regist": [4, 10], "stitch_til": [4, 10], "rounds_and_channel": [4, 14], "align_channels_and_round": [4, 11], "align_within_channel": [4, 11], "apply_correct": [4, 11], "estimate_correct": [4, 11], "estimate_rotation_angl": [4, 11], "estimate_rotation_transl": [4, 11], "estimate_scale_rotation_transl": [4, 11], "estimate_shifts_and_angles_for_til": [4, 11], "estimate_shifts_for_til": [4, 11], "generate_channel_round_transform": [4, 11], "get_channel_reference_imag": [4, 11], "register_channels_and_round": [4, 11], "make_transform": [4, 11], "phase_corr": [4, 11], "transform_imag": [4, 11], "convolve_spot": [4, 12], "segment_spot_imag": [4, 12], "cellpose_segment": [4, 12], "count_spot": [4, 12], "spot_mask_valu": [4, 12], "mask": [4, 10, 12], "npix": [4, 12], "detect_isolated_spot": [4, 12], "detect_spot": [4, 12], "make_spot_imag": [4, 12], "adjacent_tiles_registr": [4, 13], "plot_correction_imag": [4, 13], "plot_matrix_differ": [4, 13], "plot_registr": [4, 13], "plot_tilestats_distribut": [4, 13], "add_bases_legend": [4, 13], "animate_sequencing_round": [4, 13], "make_lut": [4, 13], "plot_gene_matrix": [4, 13], "plot_gene_templ": [4, 13], "plot_sequencing_round": [4, 13], "plot_spot_sign_imag": [4, 13], "plot_spot": [4, 13], "round_to_rgb": [4, 13], "to_rgb": [4, 13], "separate_round": 5, "true": [5, 8, 9, 10, 11, 12, 13], "nsampl": 5, "none": [5, 7, 8, 10, 11, 12, 13], "list": [5, 8, 10, 13], "object": [5, 12], "bool": [5, 8, 9, 10, 11, 12, 13], "whether": [5, 8, 10, 11], "separ": 5, "numpi": [5, 8, 9, 10, 11, 12], "arrai": [5, 8, 9, 10, 11, 12, 13], "int": [5, 7, 8, 9, 10, 11, 12, 13], "number": [5, 7, 9, 10, 11, 12, 13, 15], "sampl": 5, "fit": [5, 8, 10, 12], "gmm": 5, "return": [5, 7, 8, 9, 10, 11, 12, 13, 15], "x": [5, 7, 8, 9, 10, 11, 12, 13, 15], "id": [5, 10, 12], "provid": [5, 10, 11, 12, 13, 15], "ndarrai": [5, 7, 8, 9, 10, 11, 12, 13], "gener": [5, 9, 10, 11, 12, 15], "panda": [5, 9, 10, 12, 13], "datafram": [5, 9, 10, 12, 13], "gii": 5, "seq": 5, "column": [5, 10, 12, 13, 15], "most": [5, 9], "close": 5, "edit": 5, "distanc": [5, 10, 12], "max_edit_dist": 5, "stack": [5, 8, 9, 10, 11, 12, 13], "extract": 5, "trace": [5, 12], "y": [5, 8, 9, 10, 11, 12, 13, 15], "c": [5, 9, 10, 12, 13], "r": [5, 10, 13], "same": [5, 8, 9, 10, 11, 15], "valu": [5, 7, 8, 9, 10, 11, 12, 13, 15], "type": [5, 8, 9, 10, 11, 12, 13], "fals": [5, 8, 9, 10, 11, 12], "score_thresh": [5, 7, 10], "0": [5, 7, 8, 9, 10, 11, 12, 13, 15], "cluster": [5, 7, 10, 13], "one": [5, 8, 10, 15], "option": [5, 8, 9, 10, 12, 13], "plot": [5, 10, 13], "float": [5, 7, 8, 9, 10, 11, 12, 13], "argument": [5, 10], "scalar": [5, 7], "give": [5, 7], "differ": [5, 7, 10, 13, 15], "score": [5, 7, 10], "nc": 5, "onli": [5, 10], "point": [5, 7, 8, 12], "vector": [5, 7, 13], "greater": [5, 7], "than": [5, 7, 12, 15], "thi": [5, 7, 8, 9, 10, 12, 15], "contribut": [5, 7, 10], "A": [5, 8, 10, 12], "nround": [5, 10, 11, 13], "element": [5, 7, 10], "ncl": [5, 10], "nch": [5, 8, 10, 11], "becaus": [5, 7, 10, 15], "n": [5, 7, 10, 13], "equal": [5, 10], "cluster_mean": [5, 7, 10], "normal": [5, 10], "norm_shift": 5, "sequence_column": 5, "comput": [5, 7, 8, 10, 11, 12, 15], "synthet": 5, "observ": 5, "bleeedthrough": 5, "background": [5, 12], "subtract": [5, 8, 10], "tabl": [5, 10, 12, 13], "nchannel": [5, 8, 10, 11, 13], "ncluster": 5, "small": [5, 11, 15], "ad": 5, "penal": 5, "veri": [5, 10, 15], "low": 5, "str": [5, 8, 9, 10, 12, 13], "could": 5, "corrected_sequ": 5, "7": [5, 10, 12, 13], "There": 5, "have": [5, 9, 10, 12, 15], "unit": 5, "make": [5, 7, 8, 10, 11, 12], "well": [5, 10, 15], "background_vector": 5, "max_comp": 5, "tol": 5, "05": [5, 11], "automat": 5, "stop": 5, "when": [5, 15], "threshold": [5, 10, 11, 12], "reach": 5, "length": 5, "m": [5, 7, 10], "o": 5, "maximum": [5, 7, 8, 10, 11, 13], "determin": [5, 9, 10, 15], "minimum": [5, 10, 11, 12, 13], "alpha": [5, 8], "120": 5, "beta_squar": 5, "weight": 5, "refit_background": 5, "refit": 5, "everi": [5, 11], "addit": [5, 10], "add": [5, 9, 10, 12, 13], "larger": [5, 10], "posit": [5, 7, 8, 9, 10, 12, 15], "dim": 5, "gene_dict": [5, 13], "unique_gen": 5, "thresh": 5, "8": [5, 9, 10], "refin": [5, 11, 15], "templat": [5, 13], "todo": [5, 10, 12, 15], "function": [5, 10, 15], "current": [5, 10, 15], "unus": 5, "structur": [5, 7], "visual": [5, 13], "min_intens": 5, "where": [5, 7, 10, 13], "case": 5, "proce": 5, "until": 5, "intens": [5, 10, 12], "calcul": [5, 8, 10], "absolut": [5, 10], "shape": [5, 8, 10, 11, 12], "spot_sign_imag": 5, "circularli": 5, "symmetr": 5, "centr": 5, "im": [5, 8, 11, 12], "rho": 5, "an": [5, 8, 10, 11, 12, 13, 15], "similar": [5, 10, 15], "sign": [5, 10, 13], "filter": [5, 8, 10], "initi": [5, 10, 11, 12, 15], "multipli": [5, 15], "defin": [5, 10], "rel": [5, 8, 9, 10, 12, 13], "g": [5, 7, 8, 10, 13], "spot_score_threshold": [5, 10], "out": [5, 10, 11], "put": 5, "For": [5, 10, 12, 15], "its": [5, 8, 10], "n_neg": 5, "n_po": 5, "max_neg": 5, "max_po": 5, "ngene": 5, "spot_xi": 5, "neighbor_filter_s": 5, "9": [5, 8, 11], "neighbor_threshold": 5, "15": [5, 10, 11], "get": [5, 7, 9, 10, 11, 15], "radiu": [5, 7, 8, 10], "size": [5, 7, 8, 9, 10, 12], "count": [5, 10, 12, 13], "r0": 7, "r_xy": 7, "assess": 7, "param": 7, "inner": [7, 8, 10, 12], "within": [7, 10, 11, 12, 13, 15], "zero": 7, "outer": [7, 8, 12], "xy": 7, "direct": 7, "integ": [7, 12], "r_xy1": 7, "r_z": 7, "z": [7, 9, 10], "2d": [7, 9, 12], "floor": 7, "r_z1": 7, "either": [7, 8, 10], "b": 7, "t": 7, "produc": 7, "convolv": [7, 8, 12], "kernel": [7, 8, 12], "correspond": [7, 10], "1d": 7, "transform": [7, 10, 11, 15], "copi": [7, 10], "matlab": 7, "mathwork": 7, "help": 7, "ref": [7, 10], "html": 7, "q": 7, "mcclellan": 7, "r1": [7, 8], "r2": [7, 8], "two": [7, 10, 11, 15], "central": [7, 8], "neg": [7, 8, 9, 10], "sum": [7, 8], "initial_cluster_mean": 7, "min_cluster_s": 7, "n_iter": 7, "100": [7, 12], "doe": [7, 15], "minim": [7, 13], "cluster_ind": 7, "gain": [7, 15], "explicitli": 7, "n_point": 7, "n_dim": 7, "n_cluster": 7, "start": [7, 10], "less": 7, "mani": [7, 15], "perform": [7, 8, 11], "norm_cluster_mean": 7, "normalis": [7, 8, 10], "cluster_eig_valu": 7, "eigenvalu": 7, "wa": 7, "fell": 7, "below": [7, 10, 12], "top_scor": 7, "cluster_ind0": 7, "top_score0": 7, "data_path": [8, 9, 10, 12, 13, 15], "prefix": [8, 9, 10, 13, 15], "dtype": [8, 9, 12], "class": [8, 12], "precomput": [8, 10, 11], "inhomogen": 8, "path": [8, 9, 10, 12, 13], "read": [8, 10], "op": [8, 9, 10, 13, 15], "np": [8, 9, 10, 11, 12, 13, 15], "4d": 8, "dimens": [8, 9, 10], "barcode_round": [8, 10], "grand": [8, 10, 13], "barcode_round_1": 8, "singl": [8, 9, 10, 12, 13, 15], "ouput": 8, "divis": 8, "alwai": [8, 10], "max_valu": 8, "4097": 8, "statist": 8, "multichannel": [8, 11, 13], "histogram": [8, 13], "must": [8, 9, 10, 12, 15], "max": [8, 10], "distribut": [8, 10, 13], "la": 8, "circl": 8, "ch": 8, "datatyp": [8, 9, 12], "data_fold": [8, 15], "suffix": [8, 9, 10], "n_batch": [8, 10], "black_level": 8, "10000": [8, 13], "verbos": [8, 9, 10, 11, 13], "median_filt": 8, "combine_tilestat": [8, 10], "exclude_tiff": [8, 10], "everyth": [8, 9], "otherwis": [8, 10, 11], "take": [8, 10, 15], "median": [8, 10], "those": 8, "ram": 8, "black": [8, 10], "befor": [8, 9, 10], "clip": [8, 9, 10], "effect": 8, "extrem": 8, "featur": [8, 13], "skew": 8, "report": 8, "progress": [8, 9, 10, 11, 13], "divid": 8, "tilestat": [8, 10, 13], "alreadi": [8, 9, 10, 12], "tif": [8, 9, 10], "exclud": [8, 10], "tiff": [8, 9, 10], "dict": [8, 9, 10, 12, 13], "wsize": 8, "sth": [8, 10], "13": [8, 10], "focu": 8, "fast": 8, "interpol": [8, 13], "rewritten": 8, "equat": 8, "shree": 8, "nayar": 8, "1989": 8, "measur": [8, 10], "local": 8, "varianc": 8, "genes_round_1_1": [9, 10, 13, 15], "micromanag": [9, 10], "f": [9, 10, 15], "_roi_dim": [9, 15], "npy": [9, 10, 15], "should": [9, 10, 15], "except": 9, "overview": [9, 10], "thei": [9, 10, 15], "disk": 9, "nroi": 9, "roi_id": [9, 10], "ntilesx": 9, "ntilesi": 9, "fname": [9, 10], "fmetadata": 9, "om": [9, 10], "file": [9, 10, 13, 15], "probe": [9, 10], "hybridisation_prob": 9, "yml": [9, 10], "inform": [9, 10, 15], "chamber": 9, "_metadata": 9, "txt": 9, "microscop": [9, 15], "applic": 9, "yaml": [9, 10], "manual": [9, 15], "see": [9, 10, 13], "defaults_op": 9, "descript": 9, "section": [9, 10], "parent": 9, "dataset": [9, 10], "slice": [9, 10], "info": [9, 10, 13], "tile_coor": [9, 10], "tupl": [9, 10, 11, 12, 13], "xpo": [9, 10], "ypo": [9, 10], "full": [9, 10, 12, 15], "target": [9, 10, 11], "pixel_s": 9, "subresolut": [9, 10], "uint16": 9, "save_thumbnail": 9, "write": 9, "plane": 9, "pyramid": [9, 10], "bit": [9, 15], "16": 9, "micron": [9, 12], "uint8": 9, "print": [9, 10, 11, 13], "thumbnail": 9, "last": 9, "downsampl": [9, 10, 15], "bigtiff": 9, "multipag": 9, "zplane": 9, "convert": [9, 13], "p": 10, "collect": 10, "order": [10, 13], "guess": 10, "section_thickness_um": 10, "antero": 10, "posterior": 10, "olfactori": 10, "bulb": 10, "opposit": 10, "depth": 10, "um": 10, "min_step": 10, "thick": 10, "roi_slice_pos_um": 10, "full_scal": 10, "ara": [10, 13], "go": 10, "coord": 10, "associ": 10, "refer": [10, 11, 12, 13], "registration_reference_r": 10, "_sl": 10, "slice_numb": 10, "atlas_s": 10, "area": 10, "atla": 10, "area_id": 10, "slice_id": 10, "chan2us": 10, "sigma_blur": 10, "agg_func": 10, "nanmean": 10, "reference_prefix": [10, 13], "5": [10, 11, 12, 13], "max_pixel_s": 10, "acronym": 10, "inplac": [10, 12], "pd": 10, "25": 10, "50": 10, "border": [10, 12, 13], "four": 10, "more": [10, 15], "ara_x": 10, "ara_i": 10, "ara_z": 10, "sure": 10, "smoothli": 10, "here": [10, 12], "do": [10, 15], "anyth": 10, "figur": [10, 13], "grand_averag": [10, 13], "genes_round": [10, 15], "plot_tilestat": 10, "check": 10, "reason": [10, 15], "plot_titlestat": 10, "chang": [10, 15], "about": [10, 12, 13], "roi_dimension_prefix": 10, "raw": [10, 13, 15], "ransac": [10, 15], "instanc": [10, 13], "use_roi": 10, "grayscal": 10, "factor": [10, 11, 12], "correction_til": 10, "being": 10, "equalis": 10, "correction_quantil": 10, "65536": 10, "norm_factor": 10, "pixel_dist": 10, "sbatch": 10, "job": 10, "given": [10, 15], "hybridisation_1_1": 10, "color": [10, 13], "dye": [10, 15], "barcode_ref_til": 10, "dure": [10, 15], "whose": 10, "nprobe": 10, "filter_r": 10, "correct_illumin": 10, "correct_channel": 10, "filenam": [10, 13], "vignet": 10, "boolean": 10, "bad": 10, "were": 10, "due": [10, 15], "offset": 10, "discard": 10, "analysi": 10, "prepar": 10, "roi_dim": [10, 15], "additional_arg": 10, "stem": 10, "extract_til": 10, "nx3": 10, "variabl": 10, "export": 10, "pass": 10, "lead": 10, "comma": 10, "prefix_todo": 10, "subfold": [10, 15], "subtract_black": 10, "prefix_filt": 10, "_averag": 10, "folder_path": 10, "other": [10, 12, 15], "average_clip_valu": 10, "combin": 10, "pre": 10, "exist": 10, "tilex": [10, 13, 15], "tilei": [10, 13, 15], "miss": [10, 11], "rois_to_do": 10, "abba": 10, "requir": 10, "log": 10, "indic": 10, "sigma": 10, "been": 10, "successfulli": 10, "overwrit": 10, "slurm": 10, "re": [10, 11, 15], "extend": 10, "field": 10, "extens": 10, "repeat": 10, "complet": 10, "tile_roi": 10, "tile_row": 10, "max_col": 10, "dof": 10, "row": [10, 13, 15], "gene_round": 10, "Will": [10, 12], "redo": 10, "ref_prefix": 10, "previous": 10, "robust": [10, 15], "specif": 10, "max_shift": [10, 11], "500": [10, 13], "predictor": 10, "xtile": 10, "ytile": 10, "format": 10, "still": 10, "fit_angl": 10, "rotat": [10, 11, 15], "phase": [10, 11, 15], "correl": [10, 11, 15], "grid": [10, 15], "reg_prefix": 10, "binarise_quantil": 10, "ref_tile_coor": 10, "reg_channel": 10, "ref_channel": 10, "coordinat": 10, "quantil": [10, 11], "binaris": [10, 12], "allow": [10, 15], "usual": [10, 12, 15], "assum": 10, "mask_expans": 10, "barcode_dot_threshold": 10, "hyb_score_threshold": 10, "mask_id": [10, 12], "expand": 10, "expans": 10, "label": [10, 12], "masks_": 10, "abov": [10, 15], "centroid": 10, "bound": 10, "box": 10, "dapi_1": 10, "use_gpu": [10, 12], "gpu": 10, "iroi": 10, "cellpos": [10, 12], "much": [10, 11, 15], "faster": 10, "amount": 10, "vram": 10, "larg": 10, "specifici": 10, "relev": 10, "note": 10, "onc": [10, 15], "fuse": 10, "genes_df_roi": 10, "pkl": 10, "barcode_df_roi": 10, "fused_df": 10, "barcode_df": 10, "save_stack": 10, "unmix": 10, "Then": [10, 15], "result": [10, 12, 15], "map": 10, "preprocess": 10, "method": [10, 11], "round1_onli": 10, "analys": 10, "fit_norm_factor": 10, "corrected_shift": 10, "specific_round": 10, "ignor": 10, "len": 10, "avail": 10, "binar": 10, "spot_siz": [10, 12], "round1": 10, "remov": 10, "all_spot": 10, "shift_right": [10, 15], "shift_down": [10, 15], "tile_shap": [10, 15], "ntile": [10, 15], "tile_origin": [10, 15], "tile_cent": [10, 15], "center": 10, "corner": 10, "tile_corn": 10, "tile_coordin": 10, "fall": 10, "outsid": [10, 11], "spots_prefix": 10, "barcode_round_1_1": 10, "tranform": 10, "acquist": 10, "arg": 10, "avoid": [10, 11], "duplic": 10, "overlap": [10, 15], "closest": 10, "signific": 10, "better": 10, "exampl": 10, "pickl": 10, "arri": 10, "ref_coor": [10, 15], "reg_fract": 10, "ref_ch": [10, 11], "adjac": 10, "typic": 10, "whole": 10, "along": 10, "bottom": 10, "right": [10, 13], "edg": 10, "ref_til": [10, 15], "ref_round": [10, 11], "proj": 10, "ref_roi": 10, "reload": 10, "save_plot": 10, "dimension_prefix": 10, "_shift": 10, "npz": [10, 15], "instead": 10, "recomput": 10, "target_prefix": 10, "target_ch": 10, "estimate_scal": 10, "target_suffix": 10, "speed": 10, "up": [10, 13, 15], "These": [10, 15], "": [10, 11], "ich": 10, "shifts_prefix": 10, "round_01_1": 10, "tform": 11, "3x3": 11, "nan": 11, "upsampl": 11, "angle_rang": 11, "niter": 11, "nangl": 11, "min_shift": 11, "subpixel": 11, "so": 11, "how": [11, 15], "rang": [11, 13, 15], "necessari": [11, 15], "spuriou": 11, "cross": 11, "acquir": 11, "camera": [11, 13, 15], "cval": 11, "fill": 11, "empti": 11, "im_reg": 11, "ch_to_align": 11, "scale_rang": 11, "translat": 11, "what": 11, "through": 11, "reference_fft": 11, "best_angl": 11, "maxim": 11, "fourier": 11, "domain": 11, "degre": 11, "over": [11, 15], "try": 11, "max_cc": 11, "20": 11, "iter_range_factor": 11, "best": [11, 15], "decreas": 11, "gradual": 11, "smaller": 11, "shrink": 11, "01": 11, "nscale": 11, "rescal": [11, 12], "optim": 11, "threshold_quantil": 11, "carri": 11, "angles_within_channel": [11, 15], "scales_between_channel": [11, 15], "angles_between_channel": [11, 15], "shifts_between_channel": [11, 15], "shifts_within_channel": [11, 15], "stack_shap": 11, "angles_channel": 11, "shifts_channel": 11, "mean_stack": 11, "std_stack": 11, "whiten": 11, "fft_ref": 11, "correlogram": 11, "fft": 11, "cc": 11, "correlagram": 11, "kernel_um": 12, "dot_threshold": 12, "output_shap": 12, "densiti": 12, "convolut": 12, "width": 12, "dot_product_scor": 12, "smallest": 12, "spot_imag": [12, 13], "binarise_threshold": 12, "distance_threshold": 12, "debug": 12, "opencv": 12, "cut": 12, "intermedi": 12, "img": 12, "flow_threshold": 12, "min_pix": 12, "dilate_pix": 12, "55": 12, "model_typ": 12, "cyto": 12, "kwarg": 12, "flow": 12, "binari": 12, "dilat": 12, "grow": 12, "mode": 12, "forward": 12, "cellposemodel": 12, "eval": 12, "grouping_column": 12, "group": 12, "uniqu": 12, "modfi": 12, "xpix": 12, "ypix": 12, "manag": 12, "region": 12, "interest": 12, "store": 12, "rather": 12, "memori": 12, "effici": 12, "properti": 12, "detection_threshold": 12, "40": 12, "isolation_threshold": 12, "30": 12, "annulus_r": 12, "neighbor": 12, "circular": 12, "around": [12, 15], "lower": 12, "fewer": 12, "radii": 12, "simpli": [12, 15], "gaussian_width": 12, "sd": 12, "kernel_s": 12, "amplitud": 12, "saved_shift": 13, "bytile_shift": 13, "usag": 13, "down": 13, "concaten": 13, "correction_imag": 13, "figure_fold": 13, "pathlib": 13, "col_label": 13, "line_label": 13, "range_min": 13, "ax": 13, "titl": 13, "ylabel": 13, "leftmost": 13, "long": 13, "bar": 13, "plt": 13, "overlai": 13, "rais": 13, "importerror": 13, "cricksaw_analysi": 13, "instal": 13, "camera_ord": 13, "extent": 13, "channel_color": 13, "legend": 13, "xmin": 13, "xmax": 13, "ymin": 13, "ymax": 13, "savefnam": 13, "vmax": 13, "2000": 13, "anim": 13, "rgb": 13, "amd": 13, "mpeg": 13, "red": 13, "green": 13, "magenta": 13, "cyan": 13, "nlevel": 13, "256": 13, "nummber": 13, "lut": 13, "gene_df": 13, "cmap": 13, "inferno": 13, "express": 13, "sort": 13, "hierarch": 13, "gene_nam": 13, "vmin": 13, "iround": 13, "subpackag": 14, "content": 14, "common": 15, "It": 15, "few": 15, "describ": 15, "integr": 15, "hyb": 15, "anchor": 15, "mcherri": 15, "neighbour": 15, "tforms_corrected_": 15, "_": 15, "second": 15, "time": 15, "done": 15, "mirror": 15, "wobbl": 15, "stage": 15, "motor": 15, "seem": 15, "vari": 15, "iss": 15, "register_ref_til": 15, "tforms_": 15, "main": 15, "reliabl": 15, "limit": 15, "On": 15, "hand": 15, "therefor": 15, "show": 15, "narrow": 15, "fine": 15, "enough": 15, "yield": 15, "nice": 15, "captur": 15, "ideal": 15, "chromat": 15, "aberr": 15, "tube": 15, "lens": 15, "while": 15, "dichroic": 15, "slightli": 15, "dai": 15, "consist": 15, "move": 15, "both": 15, "angles_across_channel": 15, "actual": 15, "practic": 15, "tend": 15, "fail": 15, "sporad": 15, "linear": 15, "probabl": 15, "again": 15, "just": 15, "u": 15, "account": 15, "mai": 15, "perfectli": 15, "With": 15, "processed_path": 15, "independantli": 15, "want": 15, "mosaic": 15}, "objects": {"": [[4, 0, 0, "-", "iss_preprocess"]], "iss_preprocess": [[5, 0, 0, "-", "call"], [4, 0, 0, "-", "cli"], [6, 0, 0, "-", "config"], [7, 0, 0, "-", "coppafish"], [8, 0, 0, "-", "image"], [9, 0, 0, "-", "io"], [10, 0, 0, "-", "pipeline"], [11, 0, 0, "-", "reg"], [12, 0, 0, "-", "segment"], [13, 0, 0, "-", "vis"]], "iss_preprocess.call": [[5, 0, 0, "-", "call"], [5, 0, 0, "-", "omp"], [5, 0, 0, "-", "spot_shape"]], "iss_preprocess.call.call": [[5, 1, 1, "", "basecall_rois"], [5, 1, 1, "", "call_genes"], [5, 1, 1, "", "correct_barcode_sequences"], [5, 1, 1, "", "extract_spots"], [5, 1, 1, "", "get_cluster_means"], [5, 1, 1, "", "rois_to_array"]], "iss_preprocess.call.omp": [[5, 1, 1, "", "barcode_spots_dot_product"], [5, 1, 1, "", "make_background_vectors"], [5, 1, 1, "", "make_gene_templates"], [5, 1, 1, "", "omp"], [5, 1, 1, "", "omp_weighted"], [5, 1, 1, "", "refine_gene_templates"], [5, 1, 1, "", "run_omp"]], "iss_preprocess.call.spot_shape": [[5, 1, 1, "", "apply_symmetry"], [5, 1, 1, "", "detect_spots_by_shape"], [5, 1, 1, "", "find_gene_spots"], [5, 1, 1, "", "get_spot_shape"]], "iss_preprocess.coppafish": [[7, 0, 0, "-", "utils"]], "iss_preprocess.coppafish.utils": [[7, 1, 1, "", "annulus"], [7, 1, 1, "", "ftrans2"], [7, 1, 1, "", "hanning_diff"], [7, 1, 1, "", "scaled_k_means"]], "iss_preprocess.image": [[8, 0, 0, "-", "correction"], [8, 0, 0, "-", "fstack"]], "iss_preprocess.image.correction": [[8, 1, 1, "", "apply_illumination_correction"], [8, 1, 1, "", "compute_distribution"], [8, 1, 1, "", "filter_stack"], [8, 1, 1, "", "tilestats_and_mean_image"]], "iss_preprocess.image.fstack": [[8, 1, 1, "", "fstack"], [8, 1, 1, "", "fstack_channels"], [8, 1, 1, "", "gauss3P"], [8, 1, 1, "", "gfocus"]], "iss_preprocess.io": [[9, 0, 0, "-", "load"], [9, 0, 0, "-", "save"]], "iss_preprocess.io.load": [[9, 1, 1, "", "get_pixel_size"], [9, 1, 1, "", "get_roi_dimensions"], [9, 1, 1, "", "get_tile_ome"], [9, 1, 1, "", "load_hyb_probes_metadata"], [9, 1, 1, "", "load_metadata"], [9, 1, 1, "", "load_micromanager_metadata"], [9, 1, 1, "", "load_ops"], [9, 1, 1, "", "load_section_position"], [9, 1, 1, "", "load_stack"], [9, 1, 1, "", "load_tile_by_coors"]], "iss_preprocess.io.save": [[9, 1, 1, "", "save_ome_tiff_pyramid"], [9, 1, 1, "", "write_stack"]], "iss_preprocess.pipeline": [[10, 0, 0, "-", "ara_registration"], [10, 0, 0, "-", "diagnostics"], [10, 0, 0, "-", "hybridisation"], [10, 0, 0, "-", "pipeline"], [10, 0, 0, "-", "project"], [10, 0, 0, "-", "register"], [10, 0, 0, "-", "segment"], [10, 0, 0, "-", "sequencing"], [10, 0, 0, "-", "stitch"]], "iss_preprocess.pipeline.ara_registration": [[10, 1, 1, "", "find_roi_position_on_cryostat"], [10, 1, 1, "", "load_coordinate_image"], [10, 1, 1, "", "load_registration_reference_metadata"], [10, 1, 1, "", "make_area_image"], [10, 1, 1, "", "overview_single_roi"], [10, 1, 1, "", "spots_ara_infos"]], "iss_preprocess.pipeline.diagnostics": [[10, 1, 1, "", "check_illumination_correction"], [10, 1, 1, "", "check_spot_sign_image"], [10, 1, 1, "", "reg_to_ref_estimation"]], "iss_preprocess.pipeline.hybridisation": [[10, 1, 1, "", "estimate_channel_correction_hybridisation"], [10, 1, 1, "", "extract_hyb_spots_all"], [10, 1, 1, "", "extract_hyb_spots_roi"], [10, 1, 1, "", "extract_hyb_spots_tile"], [10, 1, 1, "", "hyb_spot_cluster_means"], [10, 1, 1, "", "load_and_register_hyb_tile"], [10, 1, 1, "", "setup_hyb_spot_calling"]], "iss_preprocess.pipeline.pipeline": [[10, 1, 1, "", "batch_process_tiles"], [10, 1, 1, "", "create_all_single_averages"], [10, 1, 1, "", "create_grand_averages"], [10, 1, 1, "", "create_single_average"], [10, 1, 1, "", "load_and_register_tile"], [10, 1, 1, "", "overview_for_ara_registration"]], "iss_preprocess.pipeline.project": [[10, 1, 1, "", "check_projection"], [10, 1, 1, "", "project_round"], [10, 1, 1, "", "project_tile"], [10, 1, 1, "", "project_tile_by_coors"], [10, 1, 1, "", "project_tile_row"]], "iss_preprocess.pipeline.register": [[10, 1, 1, "", "align_spots"], [10, 1, 1, "", "correct_hyb_shifts"], [10, 1, 1, "", "correct_shifts"], [10, 1, 1, "", "correct_shifts_roi"], [10, 1, 1, "", "correct_shifts_single_round_roi"], [10, 1, 1, "", "correct_shifts_to_ref"], [10, 1, 1, "", "estimate_shifts_and_angles_by_coors"], [10, 1, 1, "", "estimate_shifts_by_coors"], [10, 1, 1, "", "register_reference_tile"], [10, 1, 1, "", "register_tile_to_ref"]], "iss_preprocess.pipeline.segment": [[10, 1, 1, "", "add_mask_id"], [10, 1, 1, "", "make_cell_dataframe"], [10, 1, 1, "", "segment_all_rois"], [10, 1, 1, "", "segment_roi"], [10, 1, 1, "", "segment_spots"]], "iss_preprocess.pipeline.sequencing": [[10, 1, 1, "", "basecall_tile"], [10, 1, 1, "", "compute_spot_sign_image"], [10, 1, 1, "", "detect_genes_on_tile"], [10, 1, 1, "", "estimate_channel_correction"], [10, 1, 1, "", "load_and_register_sequencing_tile"], [10, 1, 1, "", "load_sequencing_rounds"], [10, 1, 1, "", "load_spot_sign_image"], [10, 1, 1, "", "run_omp_on_tile"], [10, 1, 1, "", "setup_barcode_calling"], [10, 1, 1, "", "setup_omp"]], "iss_preprocess.pipeline.stitch": [[10, 1, 1, "", "calculate_tile_positions"], [10, 1, 1, "", "get_tile_corners"], [10, 1, 1, "", "load_tile_ref_coors"], [10, 1, 1, "", "merge_and_align_spots"], [10, 1, 1, "", "merge_and_align_spots_all_rois"], [10, 1, 1, "", "merge_roi_spots"], [10, 1, 1, "", "register_adjacent_tiles"], [10, 1, 1, "", "register_within_acquisition"], [10, 1, 1, "", "stitch_and_register"], [10, 1, 1, "", "stitch_registered"], [10, 1, 1, "", "stitch_tiles"]], "iss_preprocess.reg": [[11, 0, 0, "-", "rounds_and_channels"], [11, 0, 0, "-", "util"]], "iss_preprocess.reg.rounds_and_channels": [[11, 1, 1, "", "align_channels_and_rounds"], [11, 1, 1, "", "align_within_channels"], [11, 1, 1, "", "apply_corrections"], [11, 1, 1, "", "estimate_correction"], [11, 1, 1, "", "estimate_rotation_angle"], [11, 1, 1, "", "estimate_rotation_translation"], [11, 1, 1, "", "estimate_scale_rotation_translation"], [11, 1, 1, "", "estimate_shifts_and_angles_for_tile"], [11, 1, 1, "", "estimate_shifts_for_tile"], [11, 1, 1, "", "generate_channel_round_transforms"], [11, 1, 1, "", "get_channel_reference_images"], [11, 1, 1, "", "register_channels_and_rounds"]], "iss_preprocess.reg.util": [[11, 1, 1, "", "make_transform"], [11, 1, 1, "", "phase_corr"], [11, 1, 1, "", "transform_image"]], "iss_preprocess.segment": [[12, 0, 0, "-", "barcodes"], [12, 0, 0, "-", "cells"], [12, 0, 0, "-", "roi"], [12, 0, 0, "-", "spots"]], "iss_preprocess.segment.barcodes": [[12, 1, 1, "", "convolve_spots"], [12, 1, 1, "", "segment_spot_image"]], "iss_preprocess.segment.cells": [[12, 1, 1, "", "cellpose_segmentation"], [12, 1, 1, "", "count_spots"], [12, 1, 1, "", "spot_mask_value"]], "iss_preprocess.segment.roi": [[12, 2, 1, "", "ROI"]], "iss_preprocess.segment.roi.ROI": [[12, 3, 1, "", "mask"], [12, 3, 1, "", "npix"]], "iss_preprocess.segment.spots": [[12, 1, 1, "", "detect_isolated_spots"], [12, 1, 1, "", "detect_spots"], [12, 1, 1, "", "make_spot_image"]], "iss_preprocess.vis": [[13, 0, 0, "-", "diagnostics"], [13, 0, 0, "-", "vis"]], "iss_preprocess.vis.diagnostics": [[13, 1, 1, "", "adjacent_tiles_registration"], [13, 1, 1, "", "plot_correction_images"], [13, 1, 1, "", "plot_matrix_difference"], [13, 1, 1, "", "plot_registration"], [13, 1, 1, "", "plot_tilestats_distributions"]], "iss_preprocess.vis.vis": [[13, 1, 1, "", "add_bases_legend"], [13, 1, 1, "", "animate_sequencing_rounds"], [13, 1, 1, "", "make_lut"], [13, 1, 1, "", "plot_gene_matrix"], [13, 1, 1, "", "plot_gene_templates"], [13, 1, 1, "", "plot_sequencing_rounds"], [13, 1, 1, "", "plot_spot_sign_image"], [13, 1, 1, "", "plot_spots"], [13, 1, 1, "", "round_to_rgb"], [13, 1, 1, "", "to_rgb"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "property", "Python property"]}, "titleterms": {"bleedthrough": 0, "matrix": 0, "estim": [0, 15, 17], "channel": 1, "bright": 1, "illumin": 1, "correct": [1, 8, 15], "round1_onli": 1, "option": 1, "detect": [2, 17], "hybridis": [2, 10], "spot": [2, 12, 17], "welcom": 3, "iss": 3, "preprocess": 3, "": 3, "document": 3, "content": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "api": 3, "refer": [3, 15], "instal": 3, "atla": 3, "cach": 3, "organis": 3, "thi": 3, "repositori": 3, "subpackag": [3, 4], "omp": [3, 5, 17], "pipelin": [3, 10], "exampl": 3, "indic": 3, "tabl": 3, "iss_preprocess": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "packag": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "submodul": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "cli": 4, "modul": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "call": 5, "spot_shap": 5, "config": 6, "default_op": 6, "coppafish": 7, "util": [7, 11], "imag": 8, "fstack": 8, "io": 9, "load": 9, "save": 9, "ara_registr": 10, "diagnost": [10, 13], "project": 10, "regist": [10, 15], "segment": [10, 12, 16], "sequenc": [10, 15, 17], "stitch": [10, 15], "reg": 11, "rounds_and_channel": 11, "barcod": [12, 17], "cell": [12, 16], "roi": 12, "vi": 13, "registr": 15, "round": 15, "short": 15, "version": 15, "detail": 15, "explan": 15, "part": 15, "1": 15, "angl": 15, "scale": 15, "shift": 15, "tile": 15, "all": 15, "final": 15, "2": 15, "find": 15, "merg": 15, "coordin": 15, "acquisit": 15, "togeth": 15, "gene": 17, "decod": 17, "dictionari": 17, "algorithm": 17, "basecal": 17}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Bleedthrough matrix estimation": [[0, "bleedthrough-matrix-estimation"]], "Channel brightness and illumination correction": [[1, "channel-brightness-and-illumination-correction"]], "Channel brightness": [[1, "channel-brightness"]], "round1_only option": [[1, "round1-only-option"]], "Illumination correction": [[1, "illumination-correction"]], "Detecting hybridisation spots": [[2, "detecting-hybridisation-spots"]], "Welcome to iss-preprocess\u2019s documentation!": [[3, "welcome-to-iss-preprocess-s-documentation"]], "Contents:": [[3, null]], "API reference:": [[3, null]], "ISS-preprocess": [[3, "iss-preprocess"]], "Installation": [[3, "installation"]], "Documentation": [[3, "documentation"]], "Atlas cache": [[3, "atlas-cache"]], "Organisation of this repository": [[3, "organisation-of-this-repository"]], "Subpackages": [[3, "subpackages"], [4, "subpackages"]], "OMP pipeline": [[3, "omp-pipeline"]], "Examples": [[3, "examples"]], "Indices and tables": [[3, "indices-and-tables"]], "iss_preprocess package": [[4, "iss-preprocess-package"]], "Submodules": [[4, "submodules"], [5, "submodules"], [6, "submodules"], [7, "submodules"], [8, "submodules"], [9, "submodules"], [10, "submodules"], [11, "submodules"], [12, "submodules"], [13, "submodules"]], "iss_preprocess.cli module": [[4, "module-iss_preprocess.cli"]], "Module contents": [[4, "module-iss_preprocess"], [5, "module-iss_preprocess.call"], [6, "module-iss_preprocess.config"], [7, "module-iss_preprocess.coppafish"], [8, "module-iss_preprocess.image"], [9, "module-iss_preprocess.io"], [10, "module-iss_preprocess.pipeline"], [11, "module-iss_preprocess.reg"], [12, "module-iss_preprocess.segment"], [13, "module-iss_preprocess.vis"]], "iss_preprocess.call package": [[5, "iss-preprocess-call-package"]], "iss_preprocess.call.call module": [[5, "module-iss_preprocess.call.call"]], "iss_preprocess.call.omp module": [[5, "module-iss_preprocess.call.omp"]], "iss_preprocess.call.spot_shape module": [[5, "module-iss_preprocess.call.spot_shape"]], "iss_preprocess.config package": [[6, "iss-preprocess-config-package"]], "iss_preprocess.config.default_ops module": [[6, "iss-preprocess-config-default-ops-module"]], "iss_preprocess.coppafish package": [[7, "iss-preprocess-coppafish-package"]], "iss_preprocess.coppafish.utils module": [[7, "module-iss_preprocess.coppafish.utils"]], "iss_preprocess.image package": [[8, "iss-preprocess-image-package"]], "iss_preprocess.image.correction module": [[8, "module-iss_preprocess.image.correction"]], "iss_preprocess.image.fstack module": [[8, "module-iss_preprocess.image.fstack"]], "iss_preprocess.io package": [[9, "iss-preprocess-io-package"]], "iss_preprocess.io.load module": [[9, "module-iss_preprocess.io.load"]], "iss_preprocess.io.save module": [[9, "module-iss_preprocess.io.save"]], "iss_preprocess.pipeline package": [[10, "iss-preprocess-pipeline-package"]], "iss_preprocess.pipeline.ara_registration module": [[10, "module-iss_preprocess.pipeline.ara_registration"]], "iss_preprocess.pipeline.diagnostics module": [[10, "module-iss_preprocess.pipeline.diagnostics"]], "iss_preprocess.pipeline.hybridisation module": [[10, "module-iss_preprocess.pipeline.hybridisation"]], "iss_preprocess.pipeline.pipeline module": [[10, "module-iss_preprocess.pipeline.pipeline"]], "iss_preprocess.pipeline.project module": [[10, "module-iss_preprocess.pipeline.project"]], "iss_preprocess.pipeline.register module": [[10, "module-iss_preprocess.pipeline.register"]], "iss_preprocess.pipeline.segment module": [[10, "module-iss_preprocess.pipeline.segment"]], "iss_preprocess.pipeline.sequencing module": [[10, "module-iss_preprocess.pipeline.sequencing"]], "iss_preprocess.pipeline.stitch module": [[10, "module-iss_preprocess.pipeline.stitch"]], "iss_preprocess.reg package": [[11, "iss-preprocess-reg-package"]], "iss_preprocess.reg.rounds_and_channels module": [[11, "module-iss_preprocess.reg.rounds_and_channels"]], "iss_preprocess.reg.util module": [[11, "module-iss_preprocess.reg.util"]], "iss_preprocess.segment package": [[12, "iss-preprocess-segment-package"]], "iss_preprocess.segment.barcodes module": [[12, "module-iss_preprocess.segment.barcodes"]], "iss_preprocess.segment.cells module": [[12, "module-iss_preprocess.segment.cells"]], "iss_preprocess.segment.roi module": [[12, "module-iss_preprocess.segment.roi"]], "iss_preprocess.segment.spots module": [[12, "module-iss_preprocess.segment.spots"]], "iss_preprocess.vis package": [[13, "iss-preprocess-vis-package"]], "iss_preprocess.vis.diagnostics module": [[13, "module-iss_preprocess.vis.diagnostics"]], "iss_preprocess.vis.vis module": [[13, "module-iss_preprocess.vis.vis"]], "iss_preprocess": [[14, "iss-preprocess"]], "Registration": [[15, "registration"]], "Registering sequencing rounds": [[15, "registering-sequencing-rounds"]], "Short version:": [[15, "short-version"]], "Detailed explanation part 1: Estimating angle, scale and shift": [[15, "detailed-explanation-part-1-estimating-angle-scale-and-shift"]], "Register reference tile": [[15, "register-reference-tile"]], "Estimate for all tiles": [[15, "estimate-for-all-tiles"]], "Final shift correction": [[15, "final-shift-correction"]], "Detailed explanation part 2: Stitching tiles": [[15, "detailed-explanation-part-2-stitching-tiles"]], "Find tile shifts": [[15, "find-tile-shifts"]], "Merge coordinates": [[15, "merge-coordinates"]], "Registering acquisition together": [[15, "registering-acquisition-together"]], "Cell segmentation": [[16, "cell-segmentation"]], "Gene and barcode sequencing": [[17, "gene-and-barcode-sequencing"]], "Detecting and decoding gene spots": [[17, "detecting-and-decoding-gene-spots"]], "Gene dictionary estimation": [[17, "gene-dictionary-estimation"]], "OMP algorithm": [[17, "omp-algorithm"]], "Detecting gene spots": [[17, "detecting-gene-spots"]], "Detecting and basecalling barcode spots": [[17, "detecting-and-basecalling-barcode-spots"]]}, "indexentries": {"iss_preprocess": [[4, "module-iss_preprocess"]], "iss_preprocess.cli": [[4, "module-iss_preprocess.cli"]], "module": [[4, "module-iss_preprocess"], [4, "module-iss_preprocess.cli"], [5, "module-iss_preprocess.call"], [5, "module-iss_preprocess.call.call"], [5, "module-iss_preprocess.call.omp"], [5, "module-iss_preprocess.call.spot_shape"], [6, "module-iss_preprocess.config"], [7, "module-iss_preprocess.coppafish"], [7, "module-iss_preprocess.coppafish.utils"], [8, "module-iss_preprocess.image"], [8, "module-iss_preprocess.image.correction"], [8, "module-iss_preprocess.image.fstack"], [9, "module-iss_preprocess.io"], [9, "module-iss_preprocess.io.load"], [9, "module-iss_preprocess.io.save"], [10, "module-iss_preprocess.pipeline"], [10, "module-iss_preprocess.pipeline.ara_registration"], [10, "module-iss_preprocess.pipeline.diagnostics"], [10, "module-iss_preprocess.pipeline.hybridisation"], [10, "module-iss_preprocess.pipeline.pipeline"], [10, "module-iss_preprocess.pipeline.project"], [10, "module-iss_preprocess.pipeline.register"], [10, "module-iss_preprocess.pipeline.segment"], [10, "module-iss_preprocess.pipeline.sequencing"], [10, "module-iss_preprocess.pipeline.stitch"], [11, "module-iss_preprocess.reg"], [11, "module-iss_preprocess.reg.rounds_and_channels"], [11, "module-iss_preprocess.reg.util"], [12, "module-iss_preprocess.segment"], [12, "module-iss_preprocess.segment.barcodes"], [12, "module-iss_preprocess.segment.cells"], [12, "module-iss_preprocess.segment.roi"], [12, "module-iss_preprocess.segment.spots"], [13, "module-iss_preprocess.vis"], [13, "module-iss_preprocess.vis.diagnostics"], [13, "module-iss_preprocess.vis.vis"]], "apply_symmetry() (in module iss_preprocess.call.spot_shape)": [[5, "iss_preprocess.call.spot_shape.apply_symmetry"]], "barcode_spots_dot_product() (in module iss_preprocess.call.omp)": [[5, "iss_preprocess.call.omp.barcode_spots_dot_product"]], "basecall_rois() (in module iss_preprocess.call.call)": [[5, "iss_preprocess.call.call.basecall_rois"]], "call_genes() (in module iss_preprocess.call.call)": [[5, "iss_preprocess.call.call.call_genes"]], "correct_barcode_sequences() (in module iss_preprocess.call.call)": [[5, "iss_preprocess.call.call.correct_barcode_sequences"]], "detect_spots_by_shape() (in module iss_preprocess.call.spot_shape)": [[5, "iss_preprocess.call.spot_shape.detect_spots_by_shape"]], "extract_spots() (in module iss_preprocess.call.call)": [[5, "iss_preprocess.call.call.extract_spots"]], "find_gene_spots() (in module iss_preprocess.call.spot_shape)": [[5, "iss_preprocess.call.spot_shape.find_gene_spots"]], "get_cluster_means() (in module iss_preprocess.call.call)": [[5, "iss_preprocess.call.call.get_cluster_means"]], "get_spot_shape() (in module iss_preprocess.call.spot_shape)": [[5, "iss_preprocess.call.spot_shape.get_spot_shape"]], "iss_preprocess.call": [[5, "module-iss_preprocess.call"]], "iss_preprocess.call.call": [[5, "module-iss_preprocess.call.call"]], "iss_preprocess.call.omp": [[5, "module-iss_preprocess.call.omp"]], "iss_preprocess.call.spot_shape": [[5, "module-iss_preprocess.call.spot_shape"]], "make_background_vectors() (in module iss_preprocess.call.omp)": [[5, "iss_preprocess.call.omp.make_background_vectors"]], "make_gene_templates() (in module iss_preprocess.call.omp)": [[5, "iss_preprocess.call.omp.make_gene_templates"]], "omp() (in module iss_preprocess.call.omp)": [[5, "iss_preprocess.call.omp.omp"]], "omp_weighted() (in module iss_preprocess.call.omp)": [[5, "iss_preprocess.call.omp.omp_weighted"]], "refine_gene_templates() (in module iss_preprocess.call.omp)": [[5, "iss_preprocess.call.omp.refine_gene_templates"]], "rois_to_array() (in module iss_preprocess.call.call)": [[5, "iss_preprocess.call.call.rois_to_array"]], "run_omp() (in module iss_preprocess.call.omp)": [[5, "iss_preprocess.call.omp.run_omp"]], "iss_preprocess.config": [[6, "module-iss_preprocess.config"]], "annulus() (in module iss_preprocess.coppafish.utils)": [[7, "iss_preprocess.coppafish.utils.annulus"]], "ftrans2() (in module iss_preprocess.coppafish.utils)": [[7, "iss_preprocess.coppafish.utils.ftrans2"]], "hanning_diff() (in module iss_preprocess.coppafish.utils)": [[7, "iss_preprocess.coppafish.utils.hanning_diff"]], "iss_preprocess.coppafish": [[7, "module-iss_preprocess.coppafish"]], "iss_preprocess.coppafish.utils": [[7, "module-iss_preprocess.coppafish.utils"]], "scaled_k_means() (in module iss_preprocess.coppafish.utils)": [[7, "iss_preprocess.coppafish.utils.scaled_k_means"]], "apply_illumination_correction() (in module iss_preprocess.image.correction)": [[8, "iss_preprocess.image.correction.apply_illumination_correction"]], "compute_distribution() (in module iss_preprocess.image.correction)": [[8, "iss_preprocess.image.correction.compute_distribution"]], "filter_stack() (in module iss_preprocess.image.correction)": [[8, "iss_preprocess.image.correction.filter_stack"]], "fstack() (in module iss_preprocess.image.fstack)": [[8, "iss_preprocess.image.fstack.fstack"]], "fstack_channels() (in module iss_preprocess.image.fstack)": [[8, "iss_preprocess.image.fstack.fstack_channels"]], "gauss3p() (in module iss_preprocess.image.fstack)": [[8, "iss_preprocess.image.fstack.gauss3P"]], "gfocus() (in module iss_preprocess.image.fstack)": [[8, "iss_preprocess.image.fstack.gfocus"]], "iss_preprocess.image": [[8, "module-iss_preprocess.image"]], "iss_preprocess.image.correction": [[8, "module-iss_preprocess.image.correction"]], "iss_preprocess.image.fstack": [[8, "module-iss_preprocess.image.fstack"]], "tilestats_and_mean_image() (in module iss_preprocess.image.correction)": [[8, "iss_preprocess.image.correction.tilestats_and_mean_image"]], "get_pixel_size() (in module iss_preprocess.io.load)": [[9, "iss_preprocess.io.load.get_pixel_size"]], "get_roi_dimensions() (in module iss_preprocess.io.load)": [[9, "iss_preprocess.io.load.get_roi_dimensions"]], "get_tile_ome() (in module iss_preprocess.io.load)": [[9, "iss_preprocess.io.load.get_tile_ome"]], "iss_preprocess.io": [[9, "module-iss_preprocess.io"]], "iss_preprocess.io.load": [[9, "module-iss_preprocess.io.load"]], "iss_preprocess.io.save": [[9, "module-iss_preprocess.io.save"]], "load_hyb_probes_metadata() (in module iss_preprocess.io.load)": [[9, "iss_preprocess.io.load.load_hyb_probes_metadata"]], "load_metadata() (in module iss_preprocess.io.load)": [[9, "iss_preprocess.io.load.load_metadata"]], "load_micromanager_metadata() (in module iss_preprocess.io.load)": [[9, "iss_preprocess.io.load.load_micromanager_metadata"]], "load_ops() (in module iss_preprocess.io.load)": [[9, "iss_preprocess.io.load.load_ops"]], "load_section_position() (in module iss_preprocess.io.load)": [[9, "iss_preprocess.io.load.load_section_position"]], "load_stack() (in module iss_preprocess.io.load)": [[9, "iss_preprocess.io.load.load_stack"]], "load_tile_by_coors() (in module iss_preprocess.io.load)": [[9, "iss_preprocess.io.load.load_tile_by_coors"]], "save_ome_tiff_pyramid() (in module iss_preprocess.io.save)": [[9, "iss_preprocess.io.save.save_ome_tiff_pyramid"]], "write_stack() (in module iss_preprocess.io.save)": [[9, "iss_preprocess.io.save.write_stack"]], "add_mask_id() (in module iss_preprocess.pipeline.segment)": [[10, "iss_preprocess.pipeline.segment.add_mask_id"]], "align_spots() (in module iss_preprocess.pipeline.register)": [[10, "iss_preprocess.pipeline.register.align_spots"]], "basecall_tile() (in module iss_preprocess.pipeline.sequencing)": [[10, "iss_preprocess.pipeline.sequencing.basecall_tile"]], "batch_process_tiles() (in module iss_preprocess.pipeline.pipeline)": [[10, "iss_preprocess.pipeline.pipeline.batch_process_tiles"]], "calculate_tile_positions() (in module iss_preprocess.pipeline.stitch)": [[10, "iss_preprocess.pipeline.stitch.calculate_tile_positions"]], "check_illumination_correction() (in module iss_preprocess.pipeline.diagnostics)": [[10, "iss_preprocess.pipeline.diagnostics.check_illumination_correction"]], "check_projection() (in module iss_preprocess.pipeline.project)": [[10, "iss_preprocess.pipeline.project.check_projection"]], "check_spot_sign_image() (in module iss_preprocess.pipeline.diagnostics)": [[10, "iss_preprocess.pipeline.diagnostics.check_spot_sign_image"]], "compute_spot_sign_image() (in module iss_preprocess.pipeline.sequencing)": [[10, "iss_preprocess.pipeline.sequencing.compute_spot_sign_image"]], "correct_hyb_shifts() (in module iss_preprocess.pipeline.register)": [[10, "iss_preprocess.pipeline.register.correct_hyb_shifts"]], "correct_shifts() (in module iss_preprocess.pipeline.register)": [[10, "iss_preprocess.pipeline.register.correct_shifts"]], "correct_shifts_roi() (in module iss_preprocess.pipeline.register)": [[10, "iss_preprocess.pipeline.register.correct_shifts_roi"]], "correct_shifts_single_round_roi() (in module iss_preprocess.pipeline.register)": [[10, "iss_preprocess.pipeline.register.correct_shifts_single_round_roi"]], "correct_shifts_to_ref() (in module iss_preprocess.pipeline.register)": [[10, "iss_preprocess.pipeline.register.correct_shifts_to_ref"]], "create_all_single_averages() (in module iss_preprocess.pipeline.pipeline)": [[10, "iss_preprocess.pipeline.pipeline.create_all_single_averages"]], "create_grand_averages() (in module iss_preprocess.pipeline.pipeline)": [[10, "iss_preprocess.pipeline.pipeline.create_grand_averages"]], "create_single_average() (in module iss_preprocess.pipeline.pipeline)": [[10, "iss_preprocess.pipeline.pipeline.create_single_average"]], "detect_genes_on_tile() (in module iss_preprocess.pipeline.sequencing)": [[10, "iss_preprocess.pipeline.sequencing.detect_genes_on_tile"]], "estimate_channel_correction() (in module iss_preprocess.pipeline.sequencing)": [[10, "iss_preprocess.pipeline.sequencing.estimate_channel_correction"]], "estimate_channel_correction_hybridisation() (in module iss_preprocess.pipeline.hybridisation)": [[10, "iss_preprocess.pipeline.hybridisation.estimate_channel_correction_hybridisation"]], "estimate_shifts_and_angles_by_coors() (in module iss_preprocess.pipeline.register)": [[10, "iss_preprocess.pipeline.register.estimate_shifts_and_angles_by_coors"]], "estimate_shifts_by_coors() (in module iss_preprocess.pipeline.register)": [[10, "iss_preprocess.pipeline.register.estimate_shifts_by_coors"]], "extract_hyb_spots_all() (in module iss_preprocess.pipeline.hybridisation)": [[10, "iss_preprocess.pipeline.hybridisation.extract_hyb_spots_all"]], "extract_hyb_spots_roi() (in module iss_preprocess.pipeline.hybridisation)": [[10, "iss_preprocess.pipeline.hybridisation.extract_hyb_spots_roi"]], "extract_hyb_spots_tile() (in module iss_preprocess.pipeline.hybridisation)": [[10, "iss_preprocess.pipeline.hybridisation.extract_hyb_spots_tile"]], "find_roi_position_on_cryostat() (in module iss_preprocess.pipeline.ara_registration)": [[10, "iss_preprocess.pipeline.ara_registration.find_roi_position_on_cryostat"]], "get_tile_corners() (in module iss_preprocess.pipeline.stitch)": [[10, "iss_preprocess.pipeline.stitch.get_tile_corners"]], "hyb_spot_cluster_means() (in module iss_preprocess.pipeline.hybridisation)": [[10, "iss_preprocess.pipeline.hybridisation.hyb_spot_cluster_means"]], "iss_preprocess.pipeline": [[10, "module-iss_preprocess.pipeline"]], "iss_preprocess.pipeline.ara_registration": [[10, "module-iss_preprocess.pipeline.ara_registration"]], "iss_preprocess.pipeline.diagnostics": [[10, "module-iss_preprocess.pipeline.diagnostics"]], "iss_preprocess.pipeline.hybridisation": [[10, "module-iss_preprocess.pipeline.hybridisation"]], "iss_preprocess.pipeline.pipeline": [[10, "module-iss_preprocess.pipeline.pipeline"]], "iss_preprocess.pipeline.project": [[10, "module-iss_preprocess.pipeline.project"]], "iss_preprocess.pipeline.register": [[10, "module-iss_preprocess.pipeline.register"]], "iss_preprocess.pipeline.segment": [[10, "module-iss_preprocess.pipeline.segment"]], "iss_preprocess.pipeline.sequencing": [[10, "module-iss_preprocess.pipeline.sequencing"]], "iss_preprocess.pipeline.stitch": [[10, "module-iss_preprocess.pipeline.stitch"]], "load_and_register_hyb_tile() (in module iss_preprocess.pipeline.hybridisation)": [[10, "iss_preprocess.pipeline.hybridisation.load_and_register_hyb_tile"]], "load_and_register_sequencing_tile() (in module iss_preprocess.pipeline.sequencing)": [[10, "iss_preprocess.pipeline.sequencing.load_and_register_sequencing_tile"]], "load_and_register_tile() (in module iss_preprocess.pipeline.pipeline)": [[10, "iss_preprocess.pipeline.pipeline.load_and_register_tile"]], "load_coordinate_image() (in module iss_preprocess.pipeline.ara_registration)": [[10, "iss_preprocess.pipeline.ara_registration.load_coordinate_image"]], "load_registration_reference_metadata() (in module iss_preprocess.pipeline.ara_registration)": [[10, "iss_preprocess.pipeline.ara_registration.load_registration_reference_metadata"]], "load_sequencing_rounds() (in module iss_preprocess.pipeline.sequencing)": [[10, "iss_preprocess.pipeline.sequencing.load_sequencing_rounds"]], "load_spot_sign_image() (in module iss_preprocess.pipeline.sequencing)": [[10, "iss_preprocess.pipeline.sequencing.load_spot_sign_image"]], "load_tile_ref_coors() (in module iss_preprocess.pipeline.stitch)": [[10, "iss_preprocess.pipeline.stitch.load_tile_ref_coors"]], "make_area_image() (in module iss_preprocess.pipeline.ara_registration)": [[10, "iss_preprocess.pipeline.ara_registration.make_area_image"]], "make_cell_dataframe() (in module iss_preprocess.pipeline.segment)": [[10, "iss_preprocess.pipeline.segment.make_cell_dataframe"]], "merge_and_align_spots() (in module iss_preprocess.pipeline.stitch)": [[10, "iss_preprocess.pipeline.stitch.merge_and_align_spots"]], "merge_and_align_spots_all_rois() (in module iss_preprocess.pipeline.stitch)": [[10, "iss_preprocess.pipeline.stitch.merge_and_align_spots_all_rois"]], "merge_roi_spots() (in module iss_preprocess.pipeline.stitch)": [[10, "iss_preprocess.pipeline.stitch.merge_roi_spots"]], "overview_for_ara_registration() (in module iss_preprocess.pipeline.pipeline)": [[10, "iss_preprocess.pipeline.pipeline.overview_for_ara_registration"]], "overview_single_roi() (in module iss_preprocess.pipeline.ara_registration)": [[10, "iss_preprocess.pipeline.ara_registration.overview_single_roi"]], "project_round() (in module iss_preprocess.pipeline.project)": [[10, "iss_preprocess.pipeline.project.project_round"]], "project_tile() (in module iss_preprocess.pipeline.project)": [[10, "iss_preprocess.pipeline.project.project_tile"]], "project_tile_by_coors() (in module iss_preprocess.pipeline.project)": [[10, "iss_preprocess.pipeline.project.project_tile_by_coors"]], "project_tile_row() (in module iss_preprocess.pipeline.project)": [[10, "iss_preprocess.pipeline.project.project_tile_row"]], "reg_to_ref_estimation() (in module iss_preprocess.pipeline.diagnostics)": [[10, "iss_preprocess.pipeline.diagnostics.reg_to_ref_estimation"]], "register_adjacent_tiles() (in module iss_preprocess.pipeline.stitch)": [[10, "iss_preprocess.pipeline.stitch.register_adjacent_tiles"]], "register_reference_tile() (in module iss_preprocess.pipeline.register)": [[10, "iss_preprocess.pipeline.register.register_reference_tile"]], "register_tile_to_ref() (in module iss_preprocess.pipeline.register)": [[10, "iss_preprocess.pipeline.register.register_tile_to_ref"]], "register_within_acquisition() (in module iss_preprocess.pipeline.stitch)": [[10, "iss_preprocess.pipeline.stitch.register_within_acquisition"]], "run_omp_on_tile() (in module iss_preprocess.pipeline.sequencing)": [[10, "iss_preprocess.pipeline.sequencing.run_omp_on_tile"]], "segment_all_rois() (in module iss_preprocess.pipeline.segment)": [[10, "iss_preprocess.pipeline.segment.segment_all_rois"]], "segment_roi() (in module iss_preprocess.pipeline.segment)": [[10, "iss_preprocess.pipeline.segment.segment_roi"]], "segment_spots() (in module iss_preprocess.pipeline.segment)": [[10, "iss_preprocess.pipeline.segment.segment_spots"]], "setup_barcode_calling() (in module iss_preprocess.pipeline.sequencing)": [[10, "iss_preprocess.pipeline.sequencing.setup_barcode_calling"]], "setup_hyb_spot_calling() (in module iss_preprocess.pipeline.hybridisation)": [[10, "iss_preprocess.pipeline.hybridisation.setup_hyb_spot_calling"]], "setup_omp() (in module iss_preprocess.pipeline.sequencing)": [[10, "iss_preprocess.pipeline.sequencing.setup_omp"]], "spots_ara_infos() (in module iss_preprocess.pipeline.ara_registration)": [[10, "iss_preprocess.pipeline.ara_registration.spots_ara_infos"]], "stitch_and_register() (in module iss_preprocess.pipeline.stitch)": [[10, "iss_preprocess.pipeline.stitch.stitch_and_register"]], "stitch_registered() (in module iss_preprocess.pipeline.stitch)": [[10, "iss_preprocess.pipeline.stitch.stitch_registered"]], "stitch_tiles() (in module iss_preprocess.pipeline.stitch)": [[10, "iss_preprocess.pipeline.stitch.stitch_tiles"]], "align_channels_and_rounds() (in module iss_preprocess.reg.rounds_and_channels)": [[11, "iss_preprocess.reg.rounds_and_channels.align_channels_and_rounds"]], "align_within_channels() (in module iss_preprocess.reg.rounds_and_channels)": [[11, "iss_preprocess.reg.rounds_and_channels.align_within_channels"]], "apply_corrections() (in module iss_preprocess.reg.rounds_and_channels)": [[11, "iss_preprocess.reg.rounds_and_channels.apply_corrections"]], "estimate_correction() (in module iss_preprocess.reg.rounds_and_channels)": [[11, "iss_preprocess.reg.rounds_and_channels.estimate_correction"]], "estimate_rotation_angle() (in module iss_preprocess.reg.rounds_and_channels)": [[11, "iss_preprocess.reg.rounds_and_channels.estimate_rotation_angle"]], "estimate_rotation_translation() (in module iss_preprocess.reg.rounds_and_channels)": [[11, "iss_preprocess.reg.rounds_and_channels.estimate_rotation_translation"]], "estimate_scale_rotation_translation() (in module iss_preprocess.reg.rounds_and_channels)": [[11, "iss_preprocess.reg.rounds_and_channels.estimate_scale_rotation_translation"]], "estimate_shifts_and_angles_for_tile() (in module iss_preprocess.reg.rounds_and_channels)": [[11, "iss_preprocess.reg.rounds_and_channels.estimate_shifts_and_angles_for_tile"]], "estimate_shifts_for_tile() (in module iss_preprocess.reg.rounds_and_channels)": [[11, "iss_preprocess.reg.rounds_and_channels.estimate_shifts_for_tile"]], "generate_channel_round_transforms() (in module iss_preprocess.reg.rounds_and_channels)": [[11, "iss_preprocess.reg.rounds_and_channels.generate_channel_round_transforms"]], "get_channel_reference_images() (in module iss_preprocess.reg.rounds_and_channels)": [[11, "iss_preprocess.reg.rounds_and_channels.get_channel_reference_images"]], "iss_preprocess.reg": [[11, "module-iss_preprocess.reg"]], "iss_preprocess.reg.rounds_and_channels": [[11, "module-iss_preprocess.reg.rounds_and_channels"]], "iss_preprocess.reg.util": [[11, "module-iss_preprocess.reg.util"]], "make_transform() (in module iss_preprocess.reg.util)": [[11, "iss_preprocess.reg.util.make_transform"]], "phase_corr() (in module iss_preprocess.reg.util)": [[11, "iss_preprocess.reg.util.phase_corr"]], "register_channels_and_rounds() (in module iss_preprocess.reg.rounds_and_channels)": [[11, "iss_preprocess.reg.rounds_and_channels.register_channels_and_rounds"]], "transform_image() (in module iss_preprocess.reg.util)": [[11, "iss_preprocess.reg.util.transform_image"]], "roi (class in iss_preprocess.segment.roi)": [[12, "iss_preprocess.segment.roi.ROI"]], "cellpose_segmentation() (in module iss_preprocess.segment.cells)": [[12, "iss_preprocess.segment.cells.cellpose_segmentation"]], "convolve_spots() (in module iss_preprocess.segment.barcodes)": [[12, "iss_preprocess.segment.barcodes.convolve_spots"]], "count_spots() (in module iss_preprocess.segment.cells)": [[12, "iss_preprocess.segment.cells.count_spots"]], "detect_isolated_spots() (in module iss_preprocess.segment.spots)": [[12, "iss_preprocess.segment.spots.detect_isolated_spots"]], "detect_spots() (in module iss_preprocess.segment.spots)": [[12, "iss_preprocess.segment.spots.detect_spots"]], "iss_preprocess.segment": [[12, "module-iss_preprocess.segment"]], "iss_preprocess.segment.barcodes": [[12, "module-iss_preprocess.segment.barcodes"]], "iss_preprocess.segment.cells": [[12, "module-iss_preprocess.segment.cells"]], "iss_preprocess.segment.roi": [[12, "module-iss_preprocess.segment.roi"]], "iss_preprocess.segment.spots": [[12, "module-iss_preprocess.segment.spots"]], "make_spot_image() (in module iss_preprocess.segment.spots)": [[12, "iss_preprocess.segment.spots.make_spot_image"]], "mask (iss_preprocess.segment.roi.roi property)": [[12, "iss_preprocess.segment.roi.ROI.mask"]], "npix (iss_preprocess.segment.roi.roi property)": [[12, "iss_preprocess.segment.roi.ROI.npix"]], "segment_spot_image() (in module iss_preprocess.segment.barcodes)": [[12, "iss_preprocess.segment.barcodes.segment_spot_image"]], "spot_mask_value() (in module iss_preprocess.segment.cells)": [[12, "iss_preprocess.segment.cells.spot_mask_value"]], "add_bases_legend() (in module iss_preprocess.vis.vis)": [[13, "iss_preprocess.vis.vis.add_bases_legend"]], "adjacent_tiles_registration() (in module iss_preprocess.vis.diagnostics)": [[13, "iss_preprocess.vis.diagnostics.adjacent_tiles_registration"]], "animate_sequencing_rounds() (in module iss_preprocess.vis.vis)": [[13, "iss_preprocess.vis.vis.animate_sequencing_rounds"]], "iss_preprocess.vis": [[13, "module-iss_preprocess.vis"]], "iss_preprocess.vis.diagnostics": [[13, "module-iss_preprocess.vis.diagnostics"]], "iss_preprocess.vis.vis": [[13, "module-iss_preprocess.vis.vis"]], "make_lut() (in module iss_preprocess.vis.vis)": [[13, "iss_preprocess.vis.vis.make_lut"]], "plot_correction_images() (in module iss_preprocess.vis.diagnostics)": [[13, "iss_preprocess.vis.diagnostics.plot_correction_images"]], "plot_gene_matrix() (in module iss_preprocess.vis.vis)": [[13, "iss_preprocess.vis.vis.plot_gene_matrix"]], "plot_gene_templates() (in module iss_preprocess.vis.vis)": [[13, "iss_preprocess.vis.vis.plot_gene_templates"]], "plot_matrix_difference() (in module iss_preprocess.vis.diagnostics)": [[13, "iss_preprocess.vis.diagnostics.plot_matrix_difference"]], "plot_registration() (in module iss_preprocess.vis.diagnostics)": [[13, "iss_preprocess.vis.diagnostics.plot_registration"]], "plot_sequencing_rounds() (in module iss_preprocess.vis.vis)": [[13, "iss_preprocess.vis.vis.plot_sequencing_rounds"]], "plot_spot_sign_image() (in module iss_preprocess.vis.vis)": [[13, "iss_preprocess.vis.vis.plot_spot_sign_image"]], "plot_spots() (in module iss_preprocess.vis.vis)": [[13, "iss_preprocess.vis.vis.plot_spots"]], "plot_tilestats_distributions() (in module iss_preprocess.vis.diagnostics)": [[13, "iss_preprocess.vis.diagnostics.plot_tilestats_distributions"]], "round_to_rgb() (in module iss_preprocess.vis.vis)": [[13, "iss_preprocess.vis.vis.round_to_rgb"]], "to_rgb() (in module iss_preprocess.vis.vis)": [[13, "iss_preprocess.vis.vis.to_rgb"]]}})